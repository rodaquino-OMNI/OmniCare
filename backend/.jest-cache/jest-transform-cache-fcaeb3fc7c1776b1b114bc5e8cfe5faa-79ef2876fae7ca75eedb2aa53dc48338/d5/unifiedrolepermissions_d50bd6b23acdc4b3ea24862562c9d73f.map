{"file":"/Users/rodrigo/claude-projects/OmniCare/backend/src/auth/unified-role-permissions.ts","mappings":"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","names":[],"sources":["/Users/rodrigo/claude-projects/OmniCare/backend/src/auth/unified-role-permissions.ts"],"sourcesContent":["/**\n * OmniCare EMR Backend - Unified Role-Based Permissions System\n * HIPAA-Compliant Permission Definitions with Role Unification\n */\n\nimport { UserRole, UserRoles, Permission, RolePermissions } from '@/types/auth.types';\n\n/**\n * Unified Role-Based Permission Matrix\n * Maps all role types (short and long form) to their permissions\n */\nexport const UNIFIED_ROLE_PERMISSIONS: Record<UserRole, RolePermissions> = {\n  [UserRoles.PHYSICIAN]: {\n    role: UserRoles.PHYSICIAN,\n    permissions: [\n      // Clinical Documentation\n      Permission.CREATE_CLINICAL_NOTES,\n      Permission.EDIT_CLINICAL_NOTES,\n      Permission.VIEW_CLINICAL_NOTES,\n      Permission.FINALIZE_CLINICAL_NOTES,\n      \n      // Prescription Management\n      Permission.CREATE_PRESCRIPTIONS,\n      Permission.MODIFY_PRESCRIPTIONS,\n      Permission.VIEW_PRESCRIPTIONS,\n      \n      // Patient Management\n      Permission.VIEW_PATIENT_RECORDS,\n      Permission.EDIT_PATIENT_RECORDS,\n      Permission.CREATE_PATIENT_RECORDS,\n      Permission.VIEW_PATIENT_DEMOGRAPHICS,\n      Permission.EDIT_PATIENT_DEMOGRAPHICS,\n      \n      // Orders and Lab Results\n      Permission.CREATE_MEDICAL_ORDERS,\n      Permission.VIEW_LAB_RESULTS,\n      Permission.ACKNOWLEDGE_CRITICAL_RESULTS,\n      \n      // Imaging and Radiology\n      Permission.VIEW_IMAGING_RESULTS,\n      \n      // Administrative Functions\n      Permission.SCHEDULE_APPOINTMENTS,\n      Permission.GENERATE_REPORTS\n    ],\n    description: 'Licensed physician with full clinical privileges',\n    restrictions: [\n      'Cannot access administrative functions',\n      'Cannot manage system configuration'\n    ]\n  },\n\n  [UserRoles.NURSING_STAFF]: {\n    role: UserRoles.NURSING_STAFF,\n    permissions: [\n      // Clinical Documentation\n      Permission.CREATE_CLINICAL_NOTES,\n      Permission.EDIT_CLINICAL_NOTES,\n      Permission.VIEW_CLINICAL_NOTES,\n      \n      // Patient Management\n      Permission.VIEW_PATIENT_RECORDS,\n      Permission.EDIT_PATIENT_RECORDS,\n      Permission.VIEW_PATIENT_DEMOGRAPHICS,\n      \n      // Nursing Functions\n      Permission.DOCUMENT_VITAL_SIGNS,\n      Permission.ADMINISTER_MEDICATIONS,\n      Permission.DOCUMENT_NURSING_CARE,\n      Permission.MANAGE_PATIENT_CARE_PLANS,\n      \n      // Orders and Lab Results\n      Permission.VIEW_LAB_RESULTS,\n      \n      // Administrative Functions\n      Permission.SCHEDULE_APPOINTMENTS\n    ],\n    description: 'Licensed nursing staff with patient care responsibilities',\n    restrictions: [\n      'Cannot create prescriptions',\n      'Cannot finalize physician notes'\n    ]\n  },\n\n  [UserRoles.ADMINISTRATIVE_STAFF]: {\n    role: UserRoles.ADMINISTRATIVE_STAFF,\n    permissions: [\n      // Administrative Functions\n      Permission.SCHEDULE_APPOINTMENTS,\n      Permission.MANAGE_BILLING,\n      Permission.PROCESS_INSURANCE,\n      Permission.GENERATE_REPORTS,\n      \n      // Patient Management\n      Permission.VIEW_PATIENT_DEMOGRAPHICS,\n      Permission.EDIT_PATIENT_DEMOGRAPHICS,\n      Permission.CREATE_PATIENT_RECORDS\n    ],\n    description: 'Administrative staff with billing and scheduling privileges',\n    restrictions: [\n      'Cannot access clinical data',\n      'Cannot view medical records'\n    ]\n  },\n\n  [UserRoles.SYSTEM_ADMINISTRATOR]: {\n    role: UserRoles.SYSTEM_ADMINISTRATOR,\n    permissions: [\n      // System Administration\n      Permission.MANAGE_USERS,\n      Permission.CONFIGURE_SYSTEM,\n      Permission.VIEW_AUDIT_LOGS,\n      Permission.MANAGE_SECURITY_SETTINGS,\n      \n      // All other permissions (admin override)\n      Permission.GENERATE_REPORTS,\n      Permission.VIEW_PATIENT_DEMOGRAPHICS,\n      Permission.SCHEDULE_APPOINTMENTS,\n      Permission.MANAGE_BILLING\n    ],\n    description: 'System administrator with full system access',\n    restrictions: [\n      'Limited clinical data access for technical purposes only'\n    ]\n  },\n\n  [UserRoles.PHARMACIST]: {\n    role: UserRoles.PHARMACIST,\n    permissions: [\n      // Prescription Management\n      Permission.VIEW_PRESCRIPTIONS,\n      Permission.VERIFY_PRESCRIPTIONS,\n      Permission.DISPENSE_MEDICATIONS,\n      Permission.MODIFY_PRESCRIPTIONS,\n      \n      // Patient Management (limited)\n      Permission.VIEW_PATIENT_DEMOGRAPHICS,\n      \n      // Clinical Documentation (limited)\n      Permission.VIEW_CLINICAL_NOTES\n    ],\n    description: 'Licensed pharmacist with medication management privileges',\n    restrictions: [\n      'Limited to medication-related activities',\n      'Cannot access full patient records'\n    ]\n  },\n\n  [UserRoles.LABORATORY_TECHNICIAN]: {\n    role: UserRoles.LABORATORY_TECHNICIAN,\n    permissions: [\n      // Orders and Lab Results\n      Permission.VIEW_LAB_RESULTS,\n      Permission.ENTER_LAB_RESULTS,\n      Permission.ACKNOWLEDGE_CRITICAL_RESULTS,\n      \n      // Patient Management (minimal)\n      Permission.VIEW_PATIENT_DEMOGRAPHICS\n    ],\n    description: 'Laboratory technician with lab result management privileges',\n    restrictions: [\n      'Limited to laboratory functions only',\n      'Cannot access clinical notes'\n    ]\n  },\n\n  [UserRoles.RADIOLOGY_TECHNICIAN]: {\n    role: UserRoles.RADIOLOGY_TECHNICIAN,\n    permissions: [\n      // Imaging and Radiology\n      Permission.PERFORM_IMAGING_STUDIES,\n      Permission.VIEW_IMAGING_RESULTS,\n      Permission.MANAGE_IMAGING_EQUIPMENT,\n      \n      // Patient Management (minimal)\n      Permission.VIEW_PATIENT_DEMOGRAPHICS\n    ],\n    description: 'Radiology technician with imaging privileges',\n    restrictions: [\n      'Limited to radiology functions only',\n      'Cannot access clinical notes'\n    ]\n  },\n\n  [UserRoles.PATIENT]: {\n    role: UserRoles.PATIENT,\n    permissions: [\n      // Patient Portal Functions\n      Permission.VIEW_OWN_RECORDS,\n      Permission.REQUEST_APPOINTMENTS,\n      Permission.MESSAGE_CARE_TEAM,\n      Permission.UPDATE_PERSONAL_INFO\n    ],\n    description: 'Patient with access to their own health information',\n    restrictions: [\n      'Can only access own records',\n      'Cannot access other patients data',\n      'Limited administrative functions'\n    ]\n  },\n\n  [UserRoles.BILLING]: {\n    role: UserRoles.BILLING,\n    permissions: [\n      // Administrative Functions\n      Permission.MANAGE_BILLING,\n      Permission.PROCESS_INSURANCE,\n      Permission.GENERATE_REPORTS,\n      \n      // Patient Management (limited)\n      Permission.VIEW_PATIENT_DEMOGRAPHICS,\n      Permission.EDIT_PATIENT_DEMOGRAPHICS\n    ],\n    description: 'Billing specialist with financial management privileges',\n    restrictions: [\n      'Limited to billing and insurance functions',\n      'Cannot access clinical data'\n    ]\n  },\n\n  [UserRoles.RECEPTIONIST]: {\n    role: UserRoles.RECEPTIONIST,\n    permissions: [\n      // Administrative Functions\n      Permission.SCHEDULE_APPOINTMENTS,\n      \n      // Patient Management (minimal)\n      Permission.VIEW_PATIENT_DEMOGRAPHICS,\n      Permission.EDIT_PATIENT_DEMOGRAPHICS,\n      Permission.CREATE_PATIENT_RECORDS\n    ],\n    description: 'Front desk staff with scheduling privileges',\n    restrictions: [\n      'Limited to scheduling and demographics',\n      'Cannot access clinical or billing data'\n    ]\n  }\n};\n\n/**\n * Get permissions for a specific role\n */\nexport function getRolePermissions(role: UserRole): Permission[] {\n  const roleInfo = UNIFIED_ROLE_PERMISSIONS[role];\n  return roleInfo ? roleInfo.permissions : [];\n}\n\n/**\n * Check if a role has a specific permission\n */\nexport function hasPermission(role: UserRole, permission: Permission): boolean {\n  const permissions = getRolePermissions(role);\n  return permissions.includes(permission);\n}\n\n/**\n * Get role information (excluding permissions for lighter payloads)\n */\nexport function getRoleInfo(role: UserRole): Omit<RolePermissions, 'permissions'> {\n  const roleInfo = UNIFIED_ROLE_PERMISSIONS[role];\n  if (!roleInfo) {\n    return {\n      role,\n      description: 'Unknown role',\n      restrictions: ['Role not defined']\n    };\n  }\n  \n  const { permissions, ...info } = roleInfo;\n  return info;\n}\n\n/**\n * Get all available roles\n */\nexport function getAllRoles(): UserRole[] {\n  return Object.keys(UNIFIED_ROLE_PERMISSIONS) as UserRole[];\n}\n\n/**\n * Check if user has any of the required permissions\n */\nexport function hasAnyPermission(role: UserRole, requiredPermissions: Permission[]): boolean {\n  const userPermissions = getRolePermissions(role);\n  return requiredPermissions.some(permission => userPermissions.includes(permission));\n}\n\n/**\n * Check if user has all of the required permissions\n */\nexport function hasAllPermissions(role: UserRole, requiredPermissions: Permission[]): boolean {\n  const userPermissions = getRolePermissions(role);\n  return requiredPermissions.every(permission => userPermissions.includes(permission));\n}"],"version":3}