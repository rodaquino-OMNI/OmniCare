4238df942eb235fe9a6e75756b5802f1
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.hl7v2ParserService = exports.HL7v2ParserService = void 0;
const logger_1 = __importDefault(require("@/utils/logger"));
const error_utils_1 = require("@/utils/error.utils");
/**
 * HL7 v2 Parser Service
 * Handles parsing, validation, and processing of HL7 v2 messages
 */
class HL7v2ParserService {
    defaultParsingOptions = {
        fieldSeparator: '|',
        componentSeparator: '^',
        repetitionSeparator: '~',
        escapeCharacter: '\\',
        subcomponentSeparator: '&',
        truncateExtraFields: false,
        allowEmptyFields: true,
        preserveWhitespace: false
    };
    defaultValidationConfig = {
        validateStructure: true,
        validateDataTypes: true,
        validateTableValues: false,
        validateConformance: true,
        strictMode: false,
        version: '2.5.1'
    };
    /**
     * Parse HL7 v2 message string into structured object
     */
    parseMessage(messageString, options = {}) {
        try {
            const parsingOptions = { ...this.defaultParsingOptions, ...options };
            // Clean the message string
            const cleanMessage = this.cleanMessageString(messageString);
            // Split into segments
            const segmentStrings = cleanMessage.split(/\r\n|\r|\n/).filter(s => s.trim());
            if (segmentStrings.length === 0) {
                throw new Error('Empty message');
            }
            // Parse MSH segment first to get encoding characters
            const mshSegment = this.parseMSHSegment(segmentStrings[0], parsingOptions);
            // Update parsing options with encoding characters from MSH
            if (mshSegment.fields.length > 1) {
                const encodingChars = mshSegment.fields[1].value;
                if (encodingChars.length >= 4) {
                    parsingOptions.componentSeparator = encodingChars[0];
                    parsingOptions.repetitionSeparator = encodingChars[1];
                    parsingOptions.escapeCharacter = encodingChars[2];
                    parsingOptions.subcomponentSeparator = encodingChars[3];
                }
            }
            // Parse all segments
            const segments = [];
            for (const segmentString of segmentStrings) {
                const segment = this.parseSegment(segmentString, parsingOptions);
                segments.push(segment);
            }
            // Extract message header information
            const messageInfo = this.extractMessageInfo(mshSegment);
            const message = {
                messageType: messageInfo.messageType,
                triggerEvent: messageInfo.triggerEvent,
                messageStructure: messageInfo.messageStructure,
                messageControlId: messageInfo.messageControlId,
                sendingApplication: messageInfo.sendingApplication,
                sendingFacility: messageInfo.sendingFacility,
                receivingApplication: messageInfo.receivingApplication,
                receivingFacility: messageInfo.receivingFacility,
                timestamp: messageInfo.timestamp,
                processingId: messageInfo.processingId,
                versionId: messageInfo.versionId,
                sequenceNumber: messageInfo.sequenceNumber,
                continuationPointer: messageInfo.continuationPointer,
                acceptAcknowledgmentType: messageInfo.acceptAcknowledgmentType,
                applicationAcknowledgmentType: messageInfo.applicationAcknowledgmentType,
                countryCode: messageInfo.countryCode,
                characterSet: messageInfo.characterSet,
                principalLanguage: messageInfo.principalLanguage,
                segments,
                rawMessage: messageString
            };
            logger_1.default.debug('HL7 v2 message parsed successfully', {
                messageType: message.messageType,
                triggerEvent: message.triggerEvent,
                messageControlId: message.messageControlId,
                segmentCount: segments.length
            });
            return message;
        }
        catch (error) {
            logger_1.default.error('Failed to parse HL7 v2 message:', error);
            throw new Error(`HL7 v2 parsing failed: ${(0, error_utils_1.getErrorMessage)(error)}`);
        }
    }
    /**
     * Parse MSH segment with special handling for encoding characters
     */
    parseMSHSegment(segmentString, options) {
        const fields = [];
        const parts = segmentString.split(options.fieldSeparator);
        if (parts[0] !== 'MSH') {
            throw new Error('First segment must be MSH');
        }
        // MSH segment has special structure
        // MSH|^~\&|...
        // Field 1 is the encoding characters
        for (let i = 1; i < parts.length; i++) {
            if (i === 1) {
                // Encoding characters field
                fields.push({ value: parts[i] });
            }
            else {
                // Regular field parsing
                const field = this.parseField(parts[i], options);
                fields.push(field);
            }
        }
        return {
            segmentType: 'MSH',
            fields
        };
    }
    /**
     * Parse a single segment
     */
    parseSegment(segmentString, options) {
        const parts = segmentString.split(options.fieldSeparator);
        const segmentType = parts[0];
        const fields = [];
        // Skip the segment type (index 0)
        for (let i = 1; i < parts.length; i++) {
            const fieldString = parts[i];
            const field = this.parseField(fieldString, options);
            fields.push(field);
        }
        return {
            segmentType,
            fields
        };
    }
    /**
     * Parse a field
     */
    parseField(fieldString, options) {
        if (!fieldString) {
            return { value: '' };
        }
        // Check for repetitions first
        if (fieldString.includes(options.repetitionSeparator)) {
            const repetitions = fieldString.split(options.repetitionSeparator);
            const repetitionFields = [];
            for (const repetition of repetitions) {
                repetitionFields.push(this.parseField(repetition, options));
            }
            return {
                value: repetitionFields,
                repetitions: repetitionFields
            };
        }
        // Check for components
        if (fieldString.includes(options.componentSeparator)) {
            const componentStrings = fieldString.split(options.componentSeparator);
            const components = [];
            for (const componentString of componentStrings) {
                const component = this.parseComponent(componentString, options);
                components.push(component);
            }
            return {
                value: components,
                components
            };
        }
        // Simple field with no components or repetitions
        return {
            value: this.unescapeString(fieldString, options)
        };
    }
    /**
     * Parse a component
     */
    parseComponent(componentString, options) {
        if (!componentString) {
            return { value: '' };
        }
        // Check for subcomponents
        if (componentString.includes(options.subcomponentSeparator)) {
            const subcomponentStrings = componentString.split(options.subcomponentSeparator);
            const subcomponents = [];
            for (const subcomponentString of subcomponentStrings) {
                subcomponents.push({
                    value: this.unescapeString(subcomponentString, options)
                });
            }
            return {
                value: subcomponents,
                subcomponents
            };
        }
        // Simple component with no subcomponents
        return {
            value: this.unescapeString(componentString, options)
        };
    }
    /**
     * Unescape HL7 v2 escape sequences
     */
    unescapeString(str, options) {
        if (!str || !str.includes(options.escapeCharacter)) {
            return str;
        }
        const escapeChar = options.escapeCharacter;
        return str
            .replace(new RegExp(`${escapeChar}F${escapeChar}`, 'g'), options.fieldSeparator)
            .replace(new RegExp(`${escapeChar}S${escapeChar}`, 'g'), options.componentSeparator)
            .replace(new RegExp(`${escapeChar}T${escapeChar}`, 'g'), options.subcomponentSeparator)
            .replace(new RegExp(`${escapeChar}R${escapeChar}`, 'g'), options.repetitionSeparator)
            .replace(new RegExp(`${escapeChar}E${escapeChar}`, 'g'), options.escapeCharacter)
            .replace(new RegExp(`${escapeChar}\.br${escapeChar}`, 'g'), '\n');
    }
    /**
     * Clean message string by removing MLLP wrappers and normalizing line endings
     */
    cleanMessageString(messageString) {
        let cleaned = messageString;
        // Remove MLLP start and end blocks
        cleaned = cleaned.replace(/^\x0B/, ''); // Start block
        cleaned = cleaned.replace(/\x1C\x0D$/, ''); // End block and carriage return
        cleaned = cleaned.replace(/\x1C$/, ''); // End block only
        cleaned = cleaned.replace(/\x0D$/, ''); // Carriage return only
        return cleaned.trim();
    }
    /**
     * Extract message information from MSH segment
     */
    extractMessageInfo(mshSegment) {
        const fields = mshSegment.fields;
        // Parse message type (MSH.9) - adjust for 0-based indexing
        let messageType = '';
        let triggerEvent = '';
        let messageStructure = '';
        if (fields.length > 7 && fields[7].value) {
            const msgTypeField = fields[7];
            if (msgTypeField.components && msgTypeField.components.length > 0) {
                messageType = this.getComponentValue(msgTypeField.components[0]);
                if (msgTypeField.components.length > 1) {
                    triggerEvent = this.getComponentValue(msgTypeField.components[1]);
                }
                if (msgTypeField.components.length > 2) {
                    messageStructure = this.getComponentValue(msgTypeField.components[2]);
                }
            }
            else {
                // Simple string format like "ADT^A01"
                const msgTypeString = String(msgTypeField.value);
                const parts = msgTypeString.split('^');
                messageType = parts[0] || '';
                triggerEvent = parts[1] || '';
                messageStructure = parts[2] || '';
            }
        }
        return {
            messageType,
            triggerEvent,
            messageStructure,
            messageControlId: this.getFieldValue(fields, 8) || '',
            sendingApplication: this.getFieldValue(fields, 1) || '',
            sendingFacility: this.getFieldValue(fields, 2) || '',
            receivingApplication: this.getFieldValue(fields, 3) || '',
            receivingFacility: this.getFieldValue(fields, 4) || '',
            timestamp: this.parseHL7DateTime(this.getFieldValue(fields, 5) || ''),
            processingId: this.getFieldValue(fields, 9) || '',
            versionId: this.getFieldValue(fields, 10) || '',
            sequenceNumber: this.parseNumber(this.getFieldValue(fields, 12)),
            continuationPointer: this.getFieldValue(fields, 13),
            acceptAcknowledgmentType: this.getFieldValue(fields, 14),
            applicationAcknowledgmentType: this.getFieldValue(fields, 15),
            countryCode: this.getFieldValue(fields, 16),
            characterSet: this.getFieldValue(fields, 17),
            principalLanguage: this.getFieldValue(fields, 18)
        };
    }
    /**
     * Get field value as string
     */
    getFieldValue(fields, index) {
        if (index >= fields.length) {
            return undefined;
        }
        const field = fields[index];
        if (field.components && field.components.length > 0) {
            return this.getComponentValue(field.components[0]);
        }
        return String(field.value || '');
    }
    /**
     * Get component value as string
     */
    getComponentValue(component) {
        if (component.subcomponents && component.subcomponents.length > 0) {
            return component.subcomponents[0].value;
        }
        return String(component.value || '');
    }
    /**
     * Parse HL7 date/time string
     */
    parseHL7DateTime(dateTimeString) {
        if (!dateTimeString) {
            return new Date();
        }
        // HL7 format: YYYYMMDDHHMMSS[.SSSS][+/-ZZZZ]
        const cleanDateTime = dateTimeString.replace(/[^0-9]/g, '');
        if (cleanDateTime.length < 8) {
            return new Date();
        }
        const year = parseInt(cleanDateTime.substring(0, 4), 10);
        const month = parseInt(cleanDateTime.substring(4, 6), 10) - 1; // JS months are 0-based
        const day = parseInt(cleanDateTime.substring(6, 8), 10);
        const hour = cleanDateTime.length > 8 ? parseInt(cleanDateTime.substring(8, 10), 10) : 0;
        const minute = cleanDateTime.length > 10 ? parseInt(cleanDateTime.substring(10, 12), 10) : 0;
        const second = cleanDateTime.length > 12 ? parseInt(cleanDateTime.substring(12, 14), 10) : 0;
        return new Date(year, month, day, hour, minute, second);
    }
    /**
     * Parse number from string
     */
    parseNumber(value) {
        if (!value) {
            return undefined;
        }
        const num = parseInt(value, 10);
        return isNaN(num) ? undefined : num;
    }
    /**
     * Validate HL7 v2 message
     */
    validateMessage(message, config = {}) {
        const validationConfig = { ...this.defaultValidationConfig, ...config };
        const errors = [];
        const warnings = [];
        try {
            // Structure validation
            if (validationConfig.validateStructure) {
                this.validateMessageStructure(message, errors, warnings);
            }
            // Data type validation
            if (validationConfig.validateDataTypes) {
                this.validateDataTypes(message, errors, warnings);
            }
            // Conformance validation
            if (validationConfig.validateConformance) {
                this.validateConformance(message, errors, warnings, validationConfig);
            }
            return {
                valid: errors.length === 0,
                errors,
                warnings,
                validatedAt: new Date()
            };
        }
        catch (error) {
            logger_1.default.error('HL7 v2 validation failed:', error);
            return {
                valid: false,
                errors: [{
                        path: 'root',
                        message: `Validation failed: ${(0, error_utils_1.getErrorMessage)(error)}`,
                        code: 'validation-error',
                        severity: 'error'
                    }],
                warnings: [],
                validatedAt: new Date()
            };
        }
    }
    /**
     * Validate message structure
     */
    validateMessageStructure(message, errors, warnings) {
        // Check for required MSH segment
        if (!message.segments.find(s => s.segmentType === 'MSH')) {
            errors.push({
                path: 'segments',
                message: 'MSH segment is required',
                code: 'required-segment',
                severity: 'error'
            });
        }
        // Check message type
        if (!message.messageType) {
            errors.push({
                path: 'messageType',
                message: 'Message type is required',
                code: 'required-field',
                severity: 'error'
            });
        }
        // Check message control ID
        if (!message.messageControlId) {
            errors.push({
                path: 'messageControlId',
                message: 'Message control ID is required',
                code: 'required-field',
                severity: 'error'
            });
        }
    }
    /**
     * Validate data types
     */
    validateDataTypes(message, errors, warnings) {
        // Basic data type validation
        for (const segment of message.segments) {
            for (let i = 0; i < segment.fields.length; i++) {
                const field = segment.fields[i];
                // Add specific data type validation logic here
                // This would depend on the segment type and field position
            }
        }
    }
    /**
     * Validate conformance
     */
    validateConformance(message, errors, warnings, config) {
        // Conformance validation would check against message profiles
        // This is a placeholder for more complex conformance checking
        if (config.messageProfile) {
            // Load and validate against message profile
            warnings.push({
                path: 'root',
                message: 'Message profile validation not yet implemented',
                code: 'not-implemented',
                severity: 'warning'
            });
        }
    }
    /**
     * Generate ACK message
     */
    generateAcknowledgment(originalMessage, ackCode, textMessage, errorCondition) {
        return {
            messageType: 'ACK',
            messageControlId: originalMessage.messageControlId,
            acknowledgmentCode: ackCode,
            textMessage,
            errorCondition,
            timestamp: new Date()
        };
    }
    /**
     * Convert acknowledgment to HL7 v2 string
     */
    acknowledgeToString(ack, sendingApplication = 'OMNICARE', sendingFacility = 'OMNICARE', receivingApplication, receivingFacility) {
        const timestamp = this.formatHL7DateTime(ack.timestamp);
        const processingId = 'P'; // Production
        const versionId = '2.5.1';
        let msh = `MSH|^~\\&|${sendingApplication}|${sendingFacility}|${receivingApplication || ''}|${receivingFacility || ''}|${timestamp}||ACK|${ack.messageControlId}|${processingId}|${versionId}`;
        let msa = `MSA|${ack.acknowledgmentCode}|${ack.messageControlId}`;
        if (ack.textMessage) {
            msa += `|${ack.textMessage}`;
        }
        let ackString = msh + '\r' + msa;
        if (ack.errorCondition) {
            let err = `ERR|||${ack.errorCondition.errorCode}`;
            if (ack.errorCondition.errorDescription) {
                err += `||||${ack.errorCondition.errorDescription}`;
            }
            ackString += '\r' + err;
        }
        return ackString;
    }
    /**
     * Format date to HL7 v2 format
     */
    formatHL7DateTime(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const hour = String(date.getHours()).padStart(2, '0');
        const minute = String(date.getMinutes()).padStart(2, '0');
        const second = String(date.getSeconds()).padStart(2, '0');
        return `${year}${month}${day}${hour}${minute}${second}`;
    }
    /**
     * Get service health status
     */
    async getHealth() {
        return {
            status: 'UP',
            details: {
                parserVersion: '1.0.0',
                supportedHL7Version: '2.5.1',
                supportedMessageTypes: [
                    'ADT', 'ORM', 'ORU', 'SIU', 'DFT', 'MFN', 'RAS', 'RDE', 'RDS', 'MDM'
                ]
            }
        };
    }
}
exports.HL7v2ParserService = HL7v2ParserService;
// Export singleton instance
exports.hl7v2ParserService = new HL7v2ParserService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3JvZHJpZ28vY2xhdWRlLXByb2plY3RzL09tbmlDYXJlL2JhY2tlbmQvc3JjL3NlcnZpY2VzL2ludGVncmF0aW9uL2hsN3YyL2hsN3YyLXBhcnNlci5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQWNBLDREQUFvQztBQUNwQyxxREFBc0Q7QUFFdEQ7OztHQUdHO0FBQ0gsTUFBYSxrQkFBa0I7SUFDckIscUJBQXFCLEdBQXdCO1FBQ25ELGNBQWMsRUFBRSxHQUFHO1FBQ25CLGtCQUFrQixFQUFFLEdBQUc7UUFDdkIsbUJBQW1CLEVBQUUsR0FBRztRQUN4QixlQUFlLEVBQUUsSUFBSTtRQUNyQixxQkFBcUIsRUFBRSxHQUFHO1FBQzFCLG1CQUFtQixFQUFFLEtBQUs7UUFDMUIsZ0JBQWdCLEVBQUUsSUFBSTtRQUN0QixrQkFBa0IsRUFBRSxLQUFLO0tBQzFCLENBQUM7SUFFTSx1QkFBdUIsR0FBMEI7UUFDdkQsaUJBQWlCLEVBQUUsSUFBSTtRQUN2QixpQkFBaUIsRUFBRSxJQUFJO1FBQ3ZCLG1CQUFtQixFQUFFLEtBQUs7UUFDMUIsbUJBQW1CLEVBQUUsSUFBSTtRQUN6QixVQUFVLEVBQUUsS0FBSztRQUNqQixPQUFPLEVBQUUsT0FBTztLQUNqQixDQUFDO0lBRUY7O09BRUc7SUFDSCxZQUFZLENBQ1YsYUFBcUIsRUFDckIsVUFBd0MsRUFBRTtRQUUxQyxJQUFJLENBQUM7WUFDSCxNQUFNLGNBQWMsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsT0FBTyxFQUFFLENBQUM7WUFFckUsMkJBQTJCO1lBQzNCLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUU1RCxzQkFBc0I7WUFDdEIsTUFBTSxjQUFjLEdBQUcsWUFBWSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUU5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Q0FBQyxTQUFTO1FBQ2IsT0FBTztZQUNMLE1BQU0sRUFBRSxJQUFJO1lBQ1osT0FBTyxFQUFFO2dCQUNQLGFBQWEsRUFBRSxPQUFPO2dCQUN0QixtQkFBbUIsRUFBRSxPQUFPO2dCQUM1QixxQkFBcUIsRUFBRTtvQkFDckIsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSztpQkFDckU7YUFDRjtTQUNGLENBQUM7SUFDSixDQUFDO0NBQ0Y7QUE3bEJELGdEQTZsQkM7QUFFRCw0QkFBNEI7QUFDZixRQUFBLGtCQUFrQixHQUFHLElBQUksa0JBQWtCLEVBQUUsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvcm9kcmlnby9jbGF1ZGUtcHJvamVjdHMvT21uaUNhcmUvYmFja2VuZC9zcmMvc2VydmljZXMvaW50ZWdyYXRpb24vaGw3djIvaGw3djItcGFyc2VyLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgSEw3djJNZXNzYWdlLFxuICBITDd2MlNlZ21lbnQsXG4gIEhMN3YyRmllbGQsXG4gIEhMN3YyQ29tcG9uZW50LFxuICBITDd2MlN1YmNvbXBvbmVudCxcbiAgSEw3djJQYXJzaW5nT3B0aW9ucyxcbiAgSEw3djJWYWxpZGF0aW9uQ29uZmlnLFxuICBITDd2MlByb2Nlc3NpbmdSZXN1bHQsXG4gIEhMN3YyQWNrbm93bGVkZ21lbnQsXG4gIEhMN3YyQWNrQ29kZSxcbiAgSEw3djJFcnJvckNvbmRpdGlvblxufSBmcm9tICcuLi90eXBlcy9obDd2Mi50eXBlcyc7XG5pbXBvcnQgeyBJbnRlZ3JhdGlvblZhbGlkYXRpb25SZXN1bHQgfSBmcm9tICcuLi90eXBlcy9pbnRlZ3JhdGlvbi50eXBlcyc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJ0AvdXRpbHMvbG9nZ2VyJztcbmltcG9ydCB7IGdldEVycm9yTWVzc2FnZSB9IGZyb20gJ0AvdXRpbHMvZXJyb3IudXRpbHMnO1xuXG4vKipcbiAqIEhMNyB2MiBQYXJzZXIgU2VydmljZVxuICogSGFuZGxlcyBwYXJzaW5nLCB2YWxpZGF0aW9uLCBhbmQgcHJvY2Vzc2luZyBvZiBITDcgdjIgbWVzc2FnZXNcbiAqL1xuZXhwb3J0IGNsYXNzIEhMN3YyUGFyc2VyU2VydmljZSB7XG4gIHByaXZhdGUgZGVmYXVsdFBhcnNpbmdPcHRpb25zOiBITDd2MlBhcnNpbmdPcHRpb25zID0ge1xuICAgIGZpZWxkU2VwYXJhdG9yOiAnfCcsXG4gICAgY29tcG9uZW50U2VwYXJhdG9yOiAnXicsXG4gICAgcmVwZXRpdGlvblNlcGFyYXRvcjogJ34nLFxuICAgIGVzY2FwZUNoYXJhY3RlcjogJ1xcXFwnLFxuICAgIHN1YmNvbXBvbmVudFNlcGFyYXRvcjogJyYnLFxuICAgIHRydW5jYXRlRXh0cmFGaWVsZHM6IGZhbHNlLFxuICAgIGFsbG93RW1wdHlGaWVsZHM6IHRydWUsXG4gICAgcHJlc2VydmVXaGl0ZXNwYWNlOiBmYWxzZVxuICB9O1xuXG4gIHByaXZhdGUgZGVmYXVsdFZhbGlkYXRpb25Db25maWc6IEhMN3YyVmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgICB2YWxpZGF0ZVN0cnVjdHVyZTogdHJ1ZSxcbiAgICB2YWxpZGF0ZURhdGFUeXBlczogdHJ1ZSxcbiAgICB2YWxpZGF0ZVRhYmxlVmFsdWVzOiBmYWxzZSxcbiAgICB2YWxpZGF0ZUNvbmZvcm1hbmNlOiB0cnVlLFxuICAgIHN0cmljdE1vZGU6IGZhbHNlLFxuICAgIHZlcnNpb246ICcyLjUuMSdcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2UgSEw3IHYyIG1lc3NhZ2Ugc3RyaW5nIGludG8gc3RydWN0dXJlZCBvYmplY3RcbiAgICovXG4gIHBhcnNlTWVzc2FnZShcbiAgICBtZXNzYWdlU3RyaW5nOiBzdHJpbmcsXG4gICAgb3B0aW9uczogUGFydGlhbDxITDd2MlBhcnNpbmdPcHRpb25zPiA9IHt9XG4gICk6IEhMN3YyTWVzc2FnZSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcnNpbmdPcHRpb25zID0geyAuLi50aGlzLmRlZmF1bHRQYXJzaW5nT3B0aW9ucywgLi4ub3B0aW9ucyB9O1xuICAgICAgXG4gICAgICAvLyBDbGVhbiB0aGUgbWVzc2FnZSBzdHJpbmdcbiAgICAgIGNvbnN0IGNsZWFuTWVzc2FnZSA9IHRoaXMuY2xlYW5NZXNzYWdlU3RyaW5nKG1lc3NhZ2VTdHJpbmcpO1xuICAgICAgXG4gICAgICAvLyBTcGxpdCBpbnRvIHNlZ21lbnRzXG4gICAgICBjb25zdCBzZWdtZW50U3RyaW5ncyA9IGNsZWFuTWVzc2FnZS5zcGxpdCgvXFxyXFxufFxccnxcXG4vKS5maWx0ZXIocyA9PiBzLnRyaW0oKSk7XG4gICAgICBcbiAgICAgIGlmIChzZWdtZW50U3RyaW5ncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbXB0eSBtZXNzYWdlJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFBhcnNlIE1TSCBzZWdtZW50IGZpcnN0IHRvIGdldCBlbmNvZGluZyBjaGFyYWN0ZXJzXG4gICAgICBjb25zdCBtc2hTZWdtZW50ID0gdGhpcy5wYXJzZU1TSFNlZ21lbnQoc2VnbWVudFN0cmluZ3NbMF0sIHBhcnNpbmdPcHRpb25zKTtcbiAgICAgIFxuICAgICAgLy8gVXBkYXRlIHBhcnNpbmcgb3B0aW9ucyB3aXRoIGVuY29kaW5nIGNoYXJhY3RlcnMgZnJvbSBNU0hcbiAgICAgIGlmIChtc2hTZWdtZW50LmZpZWxkcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGNvbnN0IGVuY29kaW5nQ2hhcnMgPSBtc2hTZWdtZW50LmZpZWxkc1sxXS52YWx1ZSBhcyBzdHJpbmc7XG4gICAgICAgIGlmIChlbmNvZGluZ0NoYXJzLmxlbmd0aCA+PSA0KSB7XG4gICAgICAgICAgcGFyc2luZ09wdGlvbnMuY29tcG9uZW50U2VwYXJhdG9yID0gZW5jb2RpbmdDaGFyc1swXTtcbiAgICAgICAgICBwYXJzaW5nT3B0aW9ucy5yZXBldGl0aW9uU2VwYXJhdG9yID0gZW5jb2RpbmdDaGFyc1sxXTtcbiAgICAgICAgICBwYXJzaW5nT3B0aW9ucy5lc2NhcGVDaGFyYWN0ZXIgPSBlbmNvZGluZ0NoYXJzWzJdO1xuICAgICAgICAgIHBhcnNpbmdPcHRpb25zLnN1YmNvbXBvbmVudFNlcGFyYXRvciA9IGVuY29kaW5nQ2hhcnNbM107XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gUGFyc2UgYWxsIHNlZ21lbnRzXG4gICAgICBjb25zdCBzZWdtZW50czogSEw3djJTZWdtZW50W10gPSBbXTtcbiAgICAgIGZvciAoY29uc3Qgc2VnbWVudFN0cmluZyBvZiBzZWdtZW50U3RyaW5ncykge1xuICAgICAgICBjb25zdCBzZWdtZW50ID0gdGhpcy5wYXJzZVNlZ21lbnQoc2VnbWVudFN0cmluZywgcGFyc2luZ09wdGlvbnMpO1xuICAgICAgICBzZWdtZW50cy5wdXNoKHNlZ21lbnQpO1xuICAgICAgfVxuXG4gICAgICAvLyBFeHRyYWN0IG1lc3NhZ2UgaGVhZGVyIGluZm9ybWF0aW9uXG4gICAgICBjb25zdCBtZXNzYWdlSW5mbyA9IHRoaXMuZXh0cmFjdE1lc3NhZ2VJbmZvKG1zaFNlZ21lbnQpO1xuXG4gICAgICBjb25zdCBtZXNzYWdlOiBITDd2Mk1lc3NhZ2UgPSB7XG4gICAgICAgIG1lc3NhZ2VUeXBlOiBtZXNzYWdlSW5mby5tZXNzYWdlVHlwZSxcbiAgICAgICAgdHJpZ2dlckV2ZW50OiBtZXNzYWdlSW5mby50cmlnZ2VyRXZlbnQsXG4gICAgICAgIG1lc3NhZ2VTdHJ1Y3R1cmU6IG1lc3NhZ2VJbmZvLm1lc3NhZ2VTdHJ1Y3R1cmUsXG4gICAgICAgIG1lc3NhZ2VDb250cm9sSWQ6IG1lc3NhZ2VJbmZvLm1lc3NhZ2VDb250cm9sSWQsXG4gICAgICAgIHNlbmRpbmdBcHBsaWNhdGlvbjogbWVzc2FnZUluZm8uc2VuZGluZ0FwcGxpY2F0aW9uLFxuICAgICAgICBzZW5kaW5nRmFjaWxpdHk6IG1lc3NhZ2VJbmZvLnNlbmRpbmdGYWNpbGl0eSxcbiAgICAgICAgcmVjZWl2aW5nQXBwbGljYXRpb246IG1lc3NhZ2VJbmZvLnJlY2VpdmluZ0FwcGxpY2F0aW9uLFxuICAgICAgICByZWNlaXZpbmdGYWNpbGl0eTogbWVzc2FnZUluZm8ucmVjZWl2aW5nRmFjaWxpdHksXG4gICAgICAgIHRpbWVzdGFtcDogbWVzc2FnZUluZm8udGltZXN0YW1wLFxuICAgICAgICBwcm9jZXNzaW5nSWQ6IG1lc3NhZ2VJbmZvLnByb2Nlc3NpbmdJZCxcbiAgICAgICAgdmVyc2lvbklkOiBtZXNzYWdlSW5mby52ZXJzaW9uSWQsXG4gICAgICAgIHNlcXVlbmNlTnVtYmVyOiBtZXNzYWdlSW5mby5zZXF1ZW5jZU51bWJlcixcbiAgICAgICAgY29udGludWF0aW9uUG9pbnRlcjogbWVzc2FnZUluZm8uY29udGludWF0aW9uUG9pbnRlcixcbiAgICAgICAgYWNjZXB0QWNrbm93bGVkZ21lbnRUeXBlOiBtZXNzYWdlSW5mby5hY2NlcHRBY2tub3dsZWRnbWVudFR5cGUsXG4gICAgICAgIGFwcGxpY2F0aW9uQWNrbm93bGVkZ21lbnRUeXBlOiBtZXNzYWdlSW5mby5hcHBsaWNhdGlvbkFja25vd2xlZGdtZW50VHlwZSxcbiAgICAgICAgY291bnRyeUNvZGU6IG1lc3NhZ2VJbmZvLmNvdW50cnlDb2RlLFxuICAgICAgICBjaGFyYWN0ZXJTZXQ6IG1lc3NhZ2VJbmZvLmNoYXJhY3RlclNldCxcbiAgICAgICAgcHJpbmNpcGFsTGFuZ3VhZ2U6IG1lc3NhZ2VJbmZvLnByaW5jaXBhbExhbmd1YWdlLFxuICAgICAgICBzZWdtZW50cyxcbiAgICAgICAgcmF3TWVzc2FnZTogbWVzc2FnZVN0cmluZ1xuICAgICAgfTtcblxuICAgICAgbG9nZ2VyLmRlYnVnKCdITDcgdjIgbWVzc2FnZSBwYXJzZWQgc3VjY2Vzc2Z1bGx5Jywge1xuICAgICAgICBtZXNzYWdlVHlwZTogbWVzc2FnZS5tZXNzYWdlVHlwZSxcbiAgICAgICAgdHJpZ2dlckV2ZW50OiBtZXNzYWdlLnRyaWdnZXJFdmVudCxcbiAgICAgICAgbWVzc2FnZUNvbnRyb2xJZDogbWVzc2FnZS5tZXNzYWdlQ29udHJvbElkLFxuICAgICAgICBzZWdtZW50Q291bnQ6IHNlZ21lbnRzLmxlbmd0aFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBITDcgdjIgbWVzc2FnZTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEhMNyB2MiBwYXJzaW5nIGZhaWxlZDogJHtnZXRFcnJvck1lc3NhZ2UoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBNU0ggc2VnbWVudCB3aXRoIHNwZWNpYWwgaGFuZGxpbmcgZm9yIGVuY29kaW5nIGNoYXJhY3RlcnNcbiAgICovXG4gIHByaXZhdGUgcGFyc2VNU0hTZWdtZW50KFxuICAgIHNlZ21lbnRTdHJpbmc6IHN0cmluZyxcbiAgICBvcHRpb25zOiBITDd2MlBhcnNpbmdPcHRpb25zXG4gICk6IEhMN3YyU2VnbWVudCB7XG4gICAgY29uc3QgZmllbGRzOiBITDd2MkZpZWxkW10gPSBbXTtcbiAgICBjb25zdCBwYXJ0cyA9IHNlZ21lbnRTdHJpbmcuc3BsaXQob3B0aW9ucy5maWVsZFNlcGFyYXRvcik7XG4gICAgXG4gICAgaWYgKHBhcnRzWzBdICE9PSAnTVNIJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaXJzdCBzZWdtZW50IG11c3QgYmUgTVNIJyk7XG4gICAgfVxuXG4gICAgLy8gTVNIIHNlZ21lbnQgaGFzIHNwZWNpYWwgc3RydWN0dXJlXG4gICAgLy8gTVNIfF5+XFwmfC4uLlxuICAgIC8vIEZpZWxkIDEgaXMgdGhlIGVuY29kaW5nIGNoYXJhY3RlcnNcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoaSA9PT0gMSkge1xuICAgICAgICAvLyBFbmNvZGluZyBjaGFyYWN0ZXJzIGZpZWxkXG4gICAgICAgIGZpZWxkcy5wdXNoKHsgdmFsdWU6IHBhcnRzW2ldIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUmVndWxhciBmaWVsZCBwYXJzaW5nXG4gICAgICAgIGNvbnN0IGZpZWxkID0gdGhpcy5wYXJzZUZpZWxkKHBhcnRzW2ldLCBvcHRpb25zKTtcbiAgICAgICAgZmllbGRzLnB1c2goZmllbGQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzZWdtZW50VHlwZTogJ01TSCcsXG4gICAgICBmaWVsZHNcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGEgc2luZ2xlIHNlZ21lbnRcbiAgICovXG4gIHByaXZhdGUgcGFyc2VTZWdtZW50KFxuICAgIHNlZ21lbnRTdHJpbmc6IHN0cmluZyxcbiAgICBvcHRpb25zOiBITDd2MlBhcnNpbmdPcHRpb25zXG4gICk6IEhMN3YyU2VnbWVudCB7XG4gICAgY29uc3QgcGFydHMgPSBzZWdtZW50U3RyaW5nLnNwbGl0KG9wdGlvbnMuZmllbGRTZXBhcmF0b3IpO1xuICAgIGNvbnN0IHNlZ21lbnRUeXBlID0gcGFydHNbMF07XG4gICAgY29uc3QgZmllbGRzOiBITDd2MkZpZWxkW10gPSBbXTtcblxuICAgIC8vIFNraXAgdGhlIHNlZ21lbnQgdHlwZSAoaW5kZXggMClcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBmaWVsZFN0cmluZyA9IHBhcnRzW2ldO1xuICAgICAgY29uc3QgZmllbGQgPSB0aGlzLnBhcnNlRmllbGQoZmllbGRTdHJpbmcsIG9wdGlvbnMpO1xuICAgICAgZmllbGRzLnB1c2goZmllbGQpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzZWdtZW50VHlwZSxcbiAgICAgIGZpZWxkc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgYSBmaWVsZFxuICAgKi9cbiAgcHJpdmF0ZSBwYXJzZUZpZWxkKFxuICAgIGZpZWxkU3RyaW5nOiBzdHJpbmcsXG4gICAgb3B0aW9uczogSEw3djJQYXJzaW5nT3B0aW9uc1xuICApOiBITDd2MkZpZWxkIHtcbiAgICBpZiAoIWZpZWxkU3RyaW5nKSB7XG4gICAgICByZXR1cm4geyB2YWx1ZTogJycgfTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgcmVwZXRpdGlvbnMgZmlyc3RcbiAgICBpZiAoZmllbGRTdHJpbmcuaW5jbHVkZXMob3B0aW9ucy5yZXBldGl0aW9uU2VwYXJhdG9yKSkge1xuICAgICAgY29uc3QgcmVwZXRpdGlvbnMgPSBmaWVsZFN0cmluZy5zcGxpdChvcHRpb25zLnJlcGV0aXRpb25TZXBhcmF0b3IpO1xuICAgICAgY29uc3QgcmVwZXRpdGlvbkZpZWxkczogSEw3djJGaWVsZFtdID0gW107XG4gICAgICBcbiAgICAgIGZvciAoY29uc3QgcmVwZXRpdGlvbiBvZiByZXBldGl0aW9ucykge1xuICAgICAgICByZXBldGl0aW9uRmllbGRzLnB1c2godGhpcy5wYXJzZUZpZWxkKHJlcGV0aXRpb24sIG9wdGlvbnMpKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHJlcGV0aXRpb25GaWVsZHMsXG4gICAgICAgIHJlcGV0aXRpb25zOiByZXBldGl0aW9uRmllbGRzXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBjb21wb25lbnRzXG4gICAgaWYgKGZpZWxkU3RyaW5nLmluY2x1ZGVzKG9wdGlvbnMuY29tcG9uZW50U2VwYXJhdG9yKSkge1xuICAgICAgY29uc3QgY29tcG9uZW50U3RyaW5ncyA9IGZpZWxkU3RyaW5nLnNwbGl0KG9wdGlvbnMuY29tcG9uZW50U2VwYXJhdG9yKTtcbiAgICAgIGNvbnN0IGNvbXBvbmVudHM6IEhMN3YyQ29tcG9uZW50W10gPSBbXTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBjb21wb25lbnRTdHJpbmcgb2YgY29tcG9uZW50U3RyaW5ncykge1xuICAgICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLnBhcnNlQ29tcG9uZW50KGNvbXBvbmVudFN0cmluZywgb3B0aW9ucyk7XG4gICAgICAgIGNvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogY29tcG9uZW50cyxcbiAgICAgICAgY29tcG9uZW50c1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBTaW1wbGUgZmllbGQgd2l0aCBubyBjb21wb25lbnRzIG9yIHJlcGV0aXRpb25zXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiB0aGlzLnVuZXNjYXBlU3RyaW5nKGZpZWxkU3RyaW5nLCBvcHRpb25zKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgYSBjb21wb25lbnRcbiAgICovXG4gIHByaXZhdGUgcGFyc2VDb21wb25lbnQoXG4gICAgY29tcG9uZW50U3RyaW5nOiBzdHJpbmcsXG4gICAgb3B0aW9uczogSEw3djJQYXJzaW5nT3B0aW9uc1xuICApOiBITDd2MkNvbXBvbmVudCB7XG4gICAgaWYgKCFjb21wb25lbnRTdHJpbmcpIHtcbiAgICAgIHJldHVybiB7IHZhbHVlOiAnJyB9O1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBzdWJjb21wb25lbnRzXG4gICAgaWYgKGNvbXBvbmVudFN0cmluZy5pbmNsdWRlcyhvcHRpb25zLnN1YmNvbXBvbmVudFNlcGFyYXRvcikpIHtcbiAgICAgIGNvbnN0IHN1YmNvbXBvbmVudFN0cmluZ3MgPSBjb21wb25lbnRTdHJpbmcuc3BsaXQob3B0aW9ucy5zdWJjb21wb25lbnRTZXBhcmF0b3IpO1xuICAgICAgY29uc3Qgc3ViY29tcG9uZW50czogSEw3djJTdWJjb21wb25lbnRbXSA9IFtdO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHN1YmNvbXBvbmVudFN0cmluZyBvZiBzdWJjb21wb25lbnRTdHJpbmdzKSB7XG4gICAgICAgIHN1YmNvbXBvbmVudHMucHVzaCh7XG4gICAgICAgICAgdmFsdWU6IHRoaXMudW5lc2NhcGVTdHJpbmcoc3ViY29tcG9uZW50U3RyaW5nLCBvcHRpb25zKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHN1YmNvbXBvbmVudHMsXG4gICAgICAgIHN1YmNvbXBvbmVudHNcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gU2ltcGxlIGNvbXBvbmVudCB3aXRoIG5vIHN1YmNvbXBvbmVudHNcbiAgICByZXR1cm4ge1xuICAgICAgdmFsdWU6IHRoaXMudW5lc2NhcGVTdHJpbmcoY29tcG9uZW50U3RyaW5nLCBvcHRpb25zKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVW5lc2NhcGUgSEw3IHYyIGVzY2FwZSBzZXF1ZW5jZXNcbiAgICovXG4gIHByaXZhdGUgdW5lc2NhcGVTdHJpbmcoXG4gICAgc3RyOiBzdHJpbmcsXG4gICAgb3B0aW9uczogSEw3djJQYXJzaW5nT3B0aW9uc1xuICApOiBzdHJpbmcge1xuICAgIGlmICghc3RyIHx8ICFzdHIuaW5jbHVkZXMob3B0aW9ucy5lc2NhcGVDaGFyYWN0ZXIpKSB7XG4gICAgICByZXR1cm4gc3RyO1xuICAgIH1cblxuICAgIGNvbnN0IGVzY2FwZUNoYXIgPSBvcHRpb25zLmVzY2FwZUNoYXJhY3RlcjtcbiAgICByZXR1cm4gc3RyXG4gICAgICAucmVwbGFjZShuZXcgUmVnRXhwKGAke2VzY2FwZUNoYXJ9RiR7ZXNjYXBlQ2hhcn1gLCAnZycpLCBvcHRpb25zLmZpZWxkU2VwYXJhdG9yKVxuICAgICAgLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtlc2NhcGVDaGFyfVMke2VzY2FwZUNoYXJ9YCwgJ2cnKSwgb3B0aW9ucy5jb21wb25lbnRTZXBhcmF0b3IpXG4gICAgICAucmVwbGFjZShuZXcgUmVnRXhwKGAke2VzY2FwZUNoYXJ9VCR7ZXNjYXBlQ2hhcn1gLCAnZycpLCBvcHRpb25zLnN1YmNvbXBvbmVudFNlcGFyYXRvcilcbiAgICAgIC5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7ZXNjYXBlQ2hhcn1SJHtlc2NhcGVDaGFyfWAsICdnJyksIG9wdGlvbnMucmVwZXRpdGlvblNlcGFyYXRvcilcbiAgICAgIC5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7ZXNjYXBlQ2hhcn1FJHtlc2NhcGVDaGFyfWAsICdnJyksIG9wdGlvbnMuZXNjYXBlQ2hhcmFjdGVyKVxuICAgICAgLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtlc2NhcGVDaGFyfVxcLmJyJHtlc2NhcGVDaGFyfWAsICdnJyksICdcXG4nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiBtZXNzYWdlIHN0cmluZyBieSByZW1vdmluZyBNTExQIHdyYXBwZXJzIGFuZCBub3JtYWxpemluZyBsaW5lIGVuZGluZ3NcbiAgICovXG4gIHByaXZhdGUgY2xlYW5NZXNzYWdlU3RyaW5nKG1lc3NhZ2VTdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgbGV0IGNsZWFuZWQgPSBtZXNzYWdlU3RyaW5nO1xuICAgIFxuICAgIC8vIFJlbW92ZSBNTExQIHN0YXJ0IGFuZCBlbmQgYmxvY2tzXG4gICAgY2xlYW5lZCA9IGNsZWFuZWQucmVwbGFjZSgvXlxceDBCLywgJycpOyAvLyBTdGFydCBibG9ja1xuICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UoL1xceDFDXFx4MEQkLywgJycpOyAvLyBFbmQgYmxvY2sgYW5kIGNhcnJpYWdlIHJldHVyblxuICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UoL1xceDFDJC8sICcnKTsgLy8gRW5kIGJsb2NrIG9ubHlcbiAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9cXHgwRCQvLCAnJyk7IC8vIENhcnJpYWdlIHJldHVybiBvbmx5XG4gICAgXG4gICAgcmV0dXJuIGNsZWFuZWQudHJpbSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgbWVzc2FnZSBpbmZvcm1hdGlvbiBmcm9tIE1TSCBzZWdtZW50XG4gICAqL1xuICBwcml2YXRlIGV4dHJhY3RNZXNzYWdlSW5mbyhtc2hTZWdtZW50OiBITDd2MlNlZ21lbnQpOiBhbnkge1xuICAgIGNvbnN0IGZpZWxkcyA9IG1zaFNlZ21lbnQuZmllbGRzO1xuICAgIFxuICAgIC8vIFBhcnNlIG1lc3NhZ2UgdHlwZSAoTVNILjkpIC0gYWRqdXN0IGZvciAwLWJhc2VkIGluZGV4aW5nXG4gICAgbGV0IG1lc3NhZ2VUeXBlID0gJyc7XG4gICAgbGV0IHRyaWdnZXJFdmVudCA9ICcnO1xuICAgIGxldCBtZXNzYWdlU3RydWN0dXJlID0gJyc7XG4gICAgXG4gICAgaWYgKGZpZWxkcy5sZW5ndGggPiA3ICYmIGZpZWxkc1s3XS52YWx1ZSkge1xuICAgICAgY29uc3QgbXNnVHlwZUZpZWxkID0gZmllbGRzWzddO1xuICAgICAgaWYgKG1zZ1R5cGVGaWVsZC5jb21wb25lbnRzICYmIG1zZ1R5cGVGaWVsZC5jb21wb25lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbWVzc2FnZVR5cGUgPSB0aGlzLmdldENvbXBvbmVudFZhbHVlKG1zZ1R5cGVGaWVsZC5jb21wb25lbnRzWzBdKTtcbiAgICAgICAgaWYgKG1zZ1R5cGVGaWVsZC5jb21wb25lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQgPSB0aGlzLmdldENvbXBvbmVudFZhbHVlKG1zZ1R5cGVGaWVsZC5jb21wb25lbnRzWzFdKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobXNnVHlwZUZpZWxkLmNvbXBvbmVudHMubGVuZ3RoID4gMikge1xuICAgICAgICAgIG1lc3NhZ2VTdHJ1Y3R1cmUgPSB0aGlzLmdldENvbXBvbmVudFZhbHVlKG1zZ1R5cGVGaWVsZC5jb21wb25lbnRzWzJdKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU2ltcGxlIHN0cmluZyBmb3JtYXQgbGlrZSBcIkFEVF5BMDFcIlxuICAgICAgICBjb25zdCBtc2dUeXBlU3RyaW5nID0gU3RyaW5nKG1zZ1R5cGVGaWVsZC52YWx1ZSk7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gbXNnVHlwZVN0cmluZy5zcGxpdCgnXicpO1xuICAgICAgICBtZXNzYWdlVHlwZSA9IHBhcnRzWzBdIHx8ICcnO1xuICAgICAgICB0cmlnZ2VyRXZlbnQgPSBwYXJ0c1sxXSB8fCAnJztcbiAgICAgICAgbWVzc2FnZVN0cnVjdHVyZSA9IHBhcnRzWzJdIHx8ICcnO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlVHlwZSxcbiAgICAgIHRyaWdnZXJFdmVudCxcbiAgICAgIG1lc3NhZ2VTdHJ1Y3R1cmUsXG4gICAgICBtZXNzYWdlQ29udHJvbElkOiB0aGlzLmdldEZpZWxkVmFsdWUoZmllbGRzLCA4KSB8fCAnJyxcbiAgICAgIHNlbmRpbmdBcHBsaWNhdGlvbjogdGhpcy5nZXRGaWVsZFZhbHVlKGZpZWxkcywgMSkgfHwgJycsXG4gICAgICBzZW5kaW5nRmFjaWxpdHk6IHRoaXMuZ2V0RmllbGRWYWx1ZShmaWVsZHMsIDIpIHx8ICcnLFxuICAgICAgcmVjZWl2aW5nQXBwbGljYXRpb246IHRoaXMuZ2V0RmllbGRWYWx1ZShmaWVsZHMsIDMpIHx8ICcnLFxuICAgICAgcmVjZWl2aW5nRmFjaWxpdHk6IHRoaXMuZ2V0RmllbGRWYWx1ZShmaWVsZHMsIDQpIHx8ICcnLFxuICAgICAgdGltZXN0YW1wOiB0aGlzLnBhcnNlSEw3RGF0ZVRpbWUodGhpcy5nZXRGaWVsZFZhbHVlKGZpZWxkcywgNSkgfHwgJycpLFxuICAgICAgcHJvY2Vzc2luZ0lkOiB0aGlzLmdldEZpZWxkVmFsdWUoZmllbGRzLCA5KSB8fCAnJyxcbiAgICAgIHZlcnNpb25JZDogdGhpcy5nZXRGaWVsZFZhbHVlKGZpZWxkcywgMTApIHx8ICcnLFxuICAgICAgc2VxdWVuY2VOdW1iZXI6IHRoaXMucGFyc2VOdW1iZXIodGhpcy5nZXRGaWVsZFZhbHVlKGZpZWxkcywgMTIpKSxcbiAgICAgIGNvbnRpbnVhdGlvblBvaW50ZXI6IHRoaXMuZ2V0RmllbGRWYWx1ZShmaWVsZHMsIDEzKSxcbiAgICAgIGFjY2VwdEFja25vd2xlZGdtZW50VHlwZTogdGhpcy5nZXRGaWVsZFZhbHVlKGZpZWxkcywgMTQpLFxuICAgICAgYXBwbGljYXRpb25BY2tub3dsZWRnbWVudFR5cGU6IHRoaXMuZ2V0RmllbGRWYWx1ZShmaWVsZHMsIDE1KSxcbiAgICAgIGNvdW50cnlDb2RlOiB0aGlzLmdldEZpZWxkVmFsdWUoZmllbGRzLCAxNiksXG4gICAgICBjaGFyYWN0ZXJTZXQ6IHRoaXMuZ2V0RmllbGRWYWx1ZShmaWVsZHMsIDE3KSxcbiAgICAgIHByaW5jaXBhbExhbmd1YWdlOiB0aGlzLmdldEZpZWxkVmFsdWUoZmllbGRzLCAxOClcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBmaWVsZCB2YWx1ZSBhcyBzdHJpbmdcbiAgICovXG4gIHByaXZhdGUgZ2V0RmllbGRWYWx1ZShmaWVsZHM6IEhMN3YyRmllbGRbXSwgaW5kZXg6IG51bWJlcik6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKGluZGV4ID49IGZpZWxkcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGZpZWxkID0gZmllbGRzW2luZGV4XTtcbiAgICBpZiAoZmllbGQuY29tcG9uZW50cyAmJiBmaWVsZC5jb21wb25lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB0aGlzLmdldENvbXBvbmVudFZhbHVlKGZpZWxkLmNvbXBvbmVudHNbMF0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gU3RyaW5nKGZpZWxkLnZhbHVlIHx8ICcnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY29tcG9uZW50IHZhbHVlIGFzIHN0cmluZ1xuICAgKi9cbiAgcHJpdmF0ZSBnZXRDb21wb25lbnRWYWx1ZShjb21wb25lbnQ6IEhMN3YyQ29tcG9uZW50KTogc3RyaW5nIHtcbiAgICBpZiAoY29tcG9uZW50LnN1YmNvbXBvbmVudHMgJiYgY29tcG9uZW50LnN1YmNvbXBvbmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGNvbXBvbmVudC5zdWJjb21wb25lbnRzWzBdLnZhbHVlO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gU3RyaW5nKGNvbXBvbmVudC52YWx1ZSB8fCAnJyk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgSEw3IGRhdGUvdGltZSBzdHJpbmdcbiAgICovXG4gIHByaXZhdGUgcGFyc2VITDdEYXRlVGltZShkYXRlVGltZVN0cmluZzogc3RyaW5nKTogRGF0ZSB7XG4gICAgaWYgKCFkYXRlVGltZVN0cmluZykge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKCk7XG4gICAgfVxuXG4gICAgLy8gSEw3IGZvcm1hdDogWVlZWU1NRERISE1NU1NbLlNTU1NdWysvLVpaWlpdXG4gICAgY29uc3QgY2xlYW5EYXRlVGltZSA9IGRhdGVUaW1lU3RyaW5nLnJlcGxhY2UoL1teMC05XS9nLCAnJyk7XG4gICAgXG4gICAgaWYgKGNsZWFuRGF0ZVRpbWUubGVuZ3RoIDwgOCkge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKCk7XG4gICAgfVxuXG4gICAgY29uc3QgeWVhciA9IHBhcnNlSW50KGNsZWFuRGF0ZVRpbWUuc3Vic3RyaW5nKDAsIDQpLCAxMCk7XG4gICAgY29uc3QgbW9udGggPSBwYXJzZUludChjbGVhbkRhdGVUaW1lLnN1YnN0cmluZyg0LCA2KSwgMTApIC0gMTsgLy8gSlMgbW9udGhzIGFyZSAwLWJhc2VkXG4gICAgY29uc3QgZGF5ID0gcGFyc2VJbnQoY2xlYW5EYXRlVGltZS5zdWJzdHJpbmcoNiwgOCksIDEwKTtcbiAgICBjb25zdCBob3VyID0gY2xlYW5EYXRlVGltZS5sZW5ndGggPiA4ID8gcGFyc2VJbnQoY2xlYW5EYXRlVGltZS5zdWJzdHJpbmcoOCwgMTApLCAxMCkgOiAwO1xuICAgIGNvbnN0IG1pbnV0ZSA9IGNsZWFuRGF0ZVRpbWUubGVuZ3RoID4gMTAgPyBwYXJzZUludChjbGVhbkRhdGVUaW1lLnN1YnN0cmluZygxMCwgMTIpLCAxMCkgOiAwO1xuICAgIGNvbnN0IHNlY29uZCA9IGNsZWFuRGF0ZVRpbWUubGVuZ3RoID4gMTIgPyBwYXJzZUludChjbGVhbkRhdGVUaW1lLnN1YnN0cmluZygxMiwgMTQpLCAxMCkgOiAwO1xuXG4gICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXksIGhvdXIsIG1pbnV0ZSwgc2Vjb25kKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBudW1iZXIgZnJvbSBzdHJpbmdcbiAgICovXG4gIHByaXZhdGUgcGFyc2VOdW1iZXIodmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICByZXR1cm4gaXNOYU4obnVtKSA/IHVuZGVmaW5lZCA6IG51bTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBITDcgdjIgbWVzc2FnZVxuICAgKi9cbiAgdmFsaWRhdGVNZXNzYWdlKFxuICAgIG1lc3NhZ2U6IEhMN3YyTWVzc2FnZSxcbiAgICBjb25maWc6IFBhcnRpYWw8SEw3djJWYWxpZGF0aW9uQ29uZmlnPiA9IHt9XG4gICk6IFZhbGlkYXRpb25SZXN1bHQge1xuICAgIGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7IC4uLnRoaXMuZGVmYXVsdFZhbGlkYXRpb25Db25maWcsIC4uLmNvbmZpZyB9O1xuICAgIGNvbnN0IGVycm9yczogYW55W10gPSBbXTtcbiAgICBjb25zdCB3YXJuaW5nczogYW55W10gPSBbXTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBTdHJ1Y3R1cmUgdmFsaWRhdGlvblxuICAgICAgaWYgKHZhbGlkYXRpb25Db25maWcudmFsaWRhdGVTdHJ1Y3R1cmUpIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZU1lc3NhZ2VTdHJ1Y3R1cmUobWVzc2FnZSwgZXJyb3JzLCB3YXJuaW5ncyk7XG4gICAgICB9XG5cbiAgICAgIC8vIERhdGEgdHlwZSB2YWxpZGF0aW9uXG4gICAgICBpZiAodmFsaWRhdGlvbkNvbmZpZy52YWxpZGF0ZURhdGFUeXBlcykge1xuICAgICAgICB0aGlzLnZhbGlkYXRlRGF0YVR5cGVzKG1lc3NhZ2UsIGVycm9ycywgd2FybmluZ3MpO1xuICAgICAgfVxuXG4gICAgICAvLyBDb25mb3JtYW5jZSB2YWxpZGF0aW9uXG4gICAgICBpZiAodmFsaWRhdGlvbkNvbmZpZy52YWxpZGF0ZUNvbmZvcm1hbmNlKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGVDb25mb3JtYW5jZShtZXNzYWdlLCBlcnJvcnMsIHdhcm5pbmdzLCB2YWxpZGF0aW9uQ29uZmlnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICAgIGVycm9ycyxcbiAgICAgICAgd2FybmluZ3MsXG4gICAgICAgIHZhbGlkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0hMNyB2MiB2YWxpZGF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yczogW3tcbiAgICAgICAgICBwYXRoOiAncm9vdCcsXG4gICAgICAgICAgbWVzc2FnZTogYFZhbGlkYXRpb24gZmFpbGVkOiAke2dldEVycm9yTWVzc2FnZShlcnJvcil9YCxcbiAgICAgICAgICBjb2RlOiAndmFsaWRhdGlvbi1lcnJvcicsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcidcbiAgICAgICAgfV0sXG4gICAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgICAgdmFsaWRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIG1lc3NhZ2Ugc3RydWN0dXJlXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlTWVzc2FnZVN0cnVjdHVyZShcbiAgICBtZXNzYWdlOiBITDd2Mk1lc3NhZ2UsXG4gICAgZXJyb3JzOiBhbnlbXSxcbiAgICB3YXJuaW5nczogYW55W11cbiAgKTogdm9pZCB7XG4gICAgLy8gQ2hlY2sgZm9yIHJlcXVpcmVkIE1TSCBzZWdtZW50XG4gICAgaWYgKCFtZXNzYWdlLnNlZ21lbnRzLmZpbmQocyA9PiBzLnNlZ21lbnRUeXBlID09PSAnTVNIJykpIHtcbiAgICAgIGVycm9ycy5wdXNoKHtcbiAgICAgICAgcGF0aDogJ3NlZ21lbnRzJyxcbiAgICAgICAgbWVzc2FnZTogJ01TSCBzZWdtZW50IGlzIHJlcXVpcmVkJyxcbiAgICAgICAgY29kZTogJ3JlcXVpcmVkLXNlZ21lbnQnLFxuICAgICAgICBzZXZlcml0eTogJ2Vycm9yJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgbWVzc2FnZSB0eXBlXG4gICAgaWYgKCFtZXNzYWdlLm1lc3NhZ2VUeXBlKSB7XG4gICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgIHBhdGg6ICdtZXNzYWdlVHlwZScsXG4gICAgICAgIG1lc3NhZ2U6ICdNZXNzYWdlIHR5cGUgaXMgcmVxdWlyZWQnLFxuICAgICAgICBjb2RlOiAncmVxdWlyZWQtZmllbGQnLFxuICAgICAgICBzZXZlcml0eTogJ2Vycm9yJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgbWVzc2FnZSBjb250cm9sIElEXG4gICAgaWYgKCFtZXNzYWdlLm1lc3NhZ2VDb250cm9sSWQpIHtcbiAgICAgIGVycm9ycy5wdXNoKHtcbiAgICAgICAgcGF0aDogJ21lc3NhZ2VDb250cm9sSWQnLFxuICAgICAgICBtZXNzYWdlOiAnTWVzc2FnZSBjb250cm9sIElEIGlzIHJlcXVpcmVkJyxcbiAgICAgICAgY29kZTogJ3JlcXVpcmVkLWZpZWxkJyxcbiAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcidcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBkYXRhIHR5cGVzXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlRGF0YVR5cGVzKFxuICAgIG1lc3NhZ2U6IEhMN3YyTWVzc2FnZSxcbiAgICBlcnJvcnM6IGFueVtdLFxuICAgIHdhcm5pbmdzOiBhbnlbXVxuICApOiB2b2lkIHtcbiAgICAvLyBCYXNpYyBkYXRhIHR5cGUgdmFsaWRhdGlvblxuICAgIGZvciAoY29uc3Qgc2VnbWVudCBvZiBtZXNzYWdlLnNlZ21lbnRzKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlZ21lbnQuZmllbGRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gc2VnbWVudC5maWVsZHNbaV07XG4gICAgICAgIC8vIEFkZCBzcGVjaWZpYyBkYXRhIHR5cGUgdmFsaWRhdGlvbiBsb2dpYyBoZXJlXG4gICAgICAgIC8vIFRoaXMgd291bGQgZGVwZW5kIG9uIHRoZSBzZWdtZW50IHR5cGUgYW5kIGZpZWxkIHBvc2l0aW9uXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIGNvbmZvcm1hbmNlXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlQ29uZm9ybWFuY2UoXG4gICAgbWVzc2FnZTogSEw3djJNZXNzYWdlLFxuICAgIGVycm9yczogYW55W10sXG4gICAgd2FybmluZ3M6IGFueVtdLFxuICAgIGNvbmZpZzogSEw3djJWYWxpZGF0aW9uQ29uZmlnXG4gICk6IHZvaWQge1xuICAgIC8vIENvbmZvcm1hbmNlIHZhbGlkYXRpb24gd291bGQgY2hlY2sgYWdhaW5zdCBtZXNzYWdlIHByb2ZpbGVzXG4gICAgLy8gVGhpcyBpcyBhIHBsYWNlaG9sZGVyIGZvciBtb3JlIGNvbXBsZXggY29uZm9ybWFuY2UgY2hlY2tpbmdcbiAgICBpZiAoY29uZmlnLm1lc3NhZ2VQcm9maWxlKSB7XG4gICAgICAvLyBMb2FkIGFuZCB2YWxpZGF0ZSBhZ2FpbnN0IG1lc3NhZ2UgcHJvZmlsZVxuICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgIHBhdGg6ICdyb290JyxcbiAgICAgICAgbWVzc2FnZTogJ01lc3NhZ2UgcHJvZmlsZSB2YWxpZGF0aW9uIG5vdCB5ZXQgaW1wbGVtZW50ZWQnLFxuICAgICAgICBjb2RlOiAnbm90LWltcGxlbWVudGVkJyxcbiAgICAgICAgc2V2ZXJpdHk6ICd3YXJuaW5nJ1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIEFDSyBtZXNzYWdlXG4gICAqL1xuICBnZW5lcmF0ZUFja25vd2xlZGdtZW50KFxuICAgIG9yaWdpbmFsTWVzc2FnZTogSEw3djJNZXNzYWdlLFxuICAgIGFja0NvZGU6IEhMN3YyQWNrQ29kZSxcbiAgICB0ZXh0TWVzc2FnZT86IHN0cmluZyxcbiAgICBlcnJvckNvbmRpdGlvbj86IEhMN3YyRXJyb3JDb25kaXRpb25cbiAgKTogSEw3djJBY2tub3dsZWRnbWVudCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1lc3NhZ2VUeXBlOiAnQUNLJyxcbiAgICAgIG1lc3NhZ2VDb250cm9sSWQ6IG9yaWdpbmFsTWVzc2FnZS5tZXNzYWdlQ29udHJvbElkLFxuICAgICAgYWNrbm93bGVkZ21lbnRDb2RlOiBhY2tDb2RlLFxuICAgICAgdGV4dE1lc3NhZ2UsXG4gICAgICBlcnJvckNvbmRpdGlvbixcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBhY2tub3dsZWRnbWVudCB0byBITDcgdjIgc3RyaW5nXG4gICAqL1xuICBhY2tub3dsZWRnZVRvU3RyaW5nKFxuICAgIGFjazogSEw3djJBY2tub3dsZWRnbWVudCxcbiAgICBzZW5kaW5nQXBwbGljYXRpb246IHN0cmluZyA9ICdPTU5JQ0FSRScsXG4gICAgc2VuZGluZ0ZhY2lsaXR5OiBzdHJpbmcgPSAnT01OSUNBUkUnLFxuICAgIHJlY2VpdmluZ0FwcGxpY2F0aW9uPzogc3RyaW5nLFxuICAgIHJlY2VpdmluZ0ZhY2lsaXR5Pzogc3RyaW5nXG4gICk6IHN0cmluZyB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gdGhpcy5mb3JtYXRITDdEYXRlVGltZShhY2sudGltZXN0YW1wKTtcbiAgICBjb25zdCBwcm9jZXNzaW5nSWQgPSAnUCc7IC8vIFByb2R1Y3Rpb25cbiAgICBjb25zdCB2ZXJzaW9uSWQgPSAnMi41LjEnO1xuICAgIFxuICAgIGxldCBtc2ggPSBgTVNIfF5+XFxcXCZ8JHtzZW5kaW5nQXBwbGljYXRpb259fCR7c2VuZGluZ0ZhY2lsaXR5fXwke3JlY2VpdmluZ0FwcGxpY2F0aW9uIHx8ICcnfXwke3JlY2VpdmluZ0ZhY2lsaXR5IHx8ICcnfXwke3RpbWVzdGFtcH18fEFDS3wke2Fjay5tZXNzYWdlQ29udHJvbElkfXwke3Byb2Nlc3NpbmdJZH18JHt2ZXJzaW9uSWR9YDtcbiAgICBcbiAgICBsZXQgbXNhID0gYE1TQXwke2Fjay5hY2tub3dsZWRnbWVudENvZGV9fCR7YWNrLm1lc3NhZ2VDb250cm9sSWR9YDtcbiAgICBpZiAoYWNrLnRleHRNZXNzYWdlKSB7XG4gICAgICBtc2EgKz0gYHwke2Fjay50ZXh0TWVzc2FnZX1gO1xuICAgIH1cbiAgICBcbiAgICBsZXQgYWNrU3RyaW5nID0gbXNoICsgJ1xccicgKyBtc2E7XG4gICAgXG4gICAgaWYgKGFjay5lcnJvckNvbmRpdGlvbikge1xuICAgICAgbGV0IGVyciA9IGBFUlJ8fHwke2Fjay5lcnJvckNvbmRpdGlvbi5lcnJvckNvZGV9YDtcbiAgICAgIGlmIChhY2suZXJyb3JDb25kaXRpb24uZXJyb3JEZXNjcmlwdGlvbikge1xuICAgICAgICBlcnIgKz0gYHx8fHwke2Fjay5lcnJvckNvbmRpdGlvbi5lcnJvckRlc2NyaXB0aW9ufWA7XG4gICAgICB9XG4gICAgICBhY2tTdHJpbmcgKz0gJ1xccicgKyBlcnI7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBhY2tTdHJpbmc7XG4gIH1cblxuICAvKipcbiAgICogRm9ybWF0IGRhdGUgdG8gSEw3IHYyIGZvcm1hdFxuICAgKi9cbiAgcHJpdmF0ZSBmb3JtYXRITDdEYXRlVGltZShkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgIGNvbnN0IG1vbnRoID0gU3RyaW5nKGRhdGUuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgY29uc3QgZGF5ID0gU3RyaW5nKGRhdGUuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIGNvbnN0IGhvdXIgPSBTdHJpbmcoZGF0ZS5nZXRIb3VycygpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIGNvbnN0IG1pbnV0ZSA9IFN0cmluZyhkYXRlLmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICBjb25zdCBzZWNvbmQgPSBTdHJpbmcoZGF0ZS5nZXRTZWNvbmRzKCkpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgXG4gICAgcmV0dXJuIGAke3llYXJ9JHttb250aH0ke2RheX0ke2hvdXJ9JHttaW51dGV9JHtzZWNvbmR9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc2VydmljZSBoZWFsdGggc3RhdHVzXG4gICAqL1xuICBhc3luYyBnZXRIZWFsdGgoKTogUHJvbWlzZTx7IHN0YXR1czogc3RyaW5nOyBkZXRhaWxzOiBhbnkgfT4ge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICdVUCcsXG4gICAgICBkZXRhaWxzOiB7XG4gICAgICAgIHBhcnNlclZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgIHN1cHBvcnRlZEhMN1ZlcnNpb246ICcyLjUuMScsXG4gICAgICAgIHN1cHBvcnRlZE1lc3NhZ2VUeXBlczogW1xuICAgICAgICAgICdBRFQnLCAnT1JNJywgJ09SVScsICdTSVUnLCAnREZUJywgJ01GTicsICdSQVMnLCAnUkRFJywgJ1JEUycsICdNRE0nXG4gICAgICAgIF1cbiAgICAgIH1cbiAgICB9O1xuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBobDd2MlBhcnNlclNlcnZpY2UgPSBuZXcgSEw3djJQYXJzZXJTZXJ2aWNlKCk7Il0sInZlcnNpb24iOjN9