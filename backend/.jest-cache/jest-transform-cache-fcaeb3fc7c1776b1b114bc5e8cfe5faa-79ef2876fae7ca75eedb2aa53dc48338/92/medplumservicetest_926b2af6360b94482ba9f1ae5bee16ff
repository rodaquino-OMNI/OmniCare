483fa79c11983d7683178a2ac55682b6
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('@medplum/core');
jest.mock('../../../src/utils/logger');
jest.mock('../../../src/config', () => ({
    medplum: {
        baseUrl: 'https://api.medplum.com/',
        clientId: 'test-client-id',
        clientSecret: 'test-client-secret',
        projectId: 'test-project-id',
        selfHosted: false,
        selfHostedUrl: 'http://localhost:8103',
    },
}));
const medplum_service_1 = require("../../../src/services/medplum.service");
const core_1 = require("@medplum/core");
const logger_1 = __importDefault(require("../../../src/utils/logger"));
const config_1 = __importDefault(require("../../../src/config"));
describe('MedplumService', () => {
    let service;
    let mockMedplumClient;
    const mockLogger = logger_1.default;
    beforeEach(() => {
        // Create mock MedplumClient instance  
        mockMedplumClient = {
            startClientLogin: jest.fn(),
            createResource: jest.fn(),
            readResource: jest.fn(),
            updateResource: jest.fn(),
            deleteResource: jest.fn(),
            searchResources: jest.fn(),
            executeBatch: jest.fn(),
            get: jest.fn(),
            graphql: jest.fn(),
            validateResource: jest.fn(),
        };
        // Mock MedplumClient constructor
        core_1.MedplumClient.mockImplementation(() => mockMedplumClient);
        service = new medplum_service_1.MedplumService();
        jest.clearAllMocks();
    });
    describe('Initialization', () => {
        it('should initialize with correct configuration for SaaS', async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found')); // For test connection
            await service.initialize();
            expect(core_1.MedplumClient).toHaveBeenCalledWith({
                baseUrl: config_1.default.medplum.baseUrl,
                clientId: config_1.default.medplum.clientId,
                fhirUrlPath: '/fhir/R4',
                tokenUrl: `${config_1.default.medplum.baseUrl}oauth2/token`,
                authorizeUrl: `${config_1.default.medplum.baseUrl}oauth2/authorize`,
            });
            expect(mockMedplumClient.startClientLogin).toHaveBeenCalledWith(config_1.default.medplum.clientId, config_1.default.medplum.clientSecret);
            expect(mockLogger.info).toHaveBeenCalledWith('Medplum FHIR server connection established successfully');
        });
        it('should initialize with correct configuration for self-hosted', async () => {
            // Mock self-hosted configuration
            const originalConfig = { ...config_1.default.medplum };
            config_1.default.medplum.selfHosted = true;
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
            expect(core_1.MedplumClient).toHaveBeenCalledWith({
                baseUrl: config_1.default.medplum.selfHostedUrl,
                clientId: config_1.default.medplum.clientId,
                fhirUrlPath: '/fhir/R4',
                tokenUrl: `${config_1.default.medplum.selfHostedUrl}/oauth2/token`,
                authorizeUrl: `${config_1.default.medplum.selfHostedUrl}/oauth2/authorize`,
            });
            // Restore original config
            config_1.default.medplum = originalConfig;
        });
        it('should handle initialization failure with retry', async () => {
            const error = new Error('Connection failed');
            mockMedplumClient.startClientLogin.mockRejectedValue(error);
            // Use fake timers to control setTimeout
            jest.useFakeTimers();
            const initPromise = service.initialize();
            // Advance timers to trigger retry
            jest.advanceTimersByTime(2000);
            // Second attempt should also fail
            mockMedplumClient.startClientLogin.mockRejectedValue(error);
            jest.useRealTimers();
            await expect(initPromise).rejects.toThrow('Connection failed');
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to initialize Medplum connection:', error);
        });
        it('should throw error after max reconnection attempts', async () => {
            const error = new Error('Persistent connection failure');
            mockMedplumClient.startClientLogin.mockRejectedValue(error);
            // Mock multiple failed attempts
            for (let i = 0; i < 6; i++) {
                mockMedplumClient.startClientLogin.mockRejectedValueOnce(error);
            }
            await expect(service.initialize()).rejects.toThrow('Failed to establish Medplum connection after 5 attempts');
        });
    });
    describe('Resource Management', () => {
        beforeEach(async () => {
            // Initialize service for resource management tests
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
        });
        describe('createResource', () => {
            it('should create a resource successfully', async () => {
                const resource = global.createMockPatient();
                const createdResource = { ...resource, id: 'created-patient-1' };
                mockMedplumClient.createResource.mockResolvedValue(createdResource);
                const result = await service.createResource(resource);
                expect(mockMedplumClient.createResource).toHaveBeenCalledWith(resource);
                expect(mockLogger.info).toHaveBeenCalledWith(`Successfully created ${resource.resourceType} with ID: ${createdResource.id}`);
                expect(result).toEqual(createdResource);
            });
            it('should handle creation errors', async () => {
                const resource = global.createMockPatient();
                const error = new Error('Creation failed');
                mockMedplumClient.createResource.mockRejectedValue(error);
                await expect(service.createResource(resource)).rejects.toThrow('Creation failed');
                expect(mockLogger.error).toHaveBeenCalledWith(`Failed to create ${resource.resourceType} resource:`, error);
            });
            it('should handle FHIR operation outcome errors', async () => {
                const resource = global.createMockPatient();
                const fhirError = {
                    outcome: {
                        issue: [
                            {
                                severity: 'error',
                                code: 'required',
                                diagnostics: 'Missing required field: name',
                            },
                        ],
                    },
                };
                mockMedplumClient.createResource.mockRejectedValue(fhirError);
                await expect(service.createResource(resource)).rejects.toThrow('FHIR Error: Missing required field: name');
            });
        });
        describe('readResource', () => {
            it('should read a resource successfully', async () => {
                const resourceType = 'Patient';
                const resourceId = 'test-patient-1';
                const resource = global.createMockPatient();
                mockMedplumClient.readResource.mockResolvedValue(resource);
                const result = await service.readResource(resourceType, resourceId);
                expect(mockMedplumClient.readResource).toHaveBeenCalledWith(resourceType, resourceId);
                expect(mockLogger.debug).toHaveBeenCalledWith(`Successfully retrieved ${resourceType} with ID: ${resourceId}`);
                expect(result).toEqual(resource);
            });
            it('should handle read errors', async () => {
                const resourceType = 'Patient';
                const resourceId = 'non-existent-patient';
                const error = new Error('Resource not found');
                mockMedplumClient.readResource.mockRejectedValue(error);
                await expect(service.readResource(resourceType, resourceId)).rejects.toThrow('Resource not found');
                expect(mockLogger.error).toHaveBeenCalledWith(`Failed to read ${resourceType} resource with ID ${resourceId}:`, error);
            });
        });
        describe('updateResource', () => {
            it('should update a resource successfully', async () => {
                const resource = { ...global.createMockPatient(), id: 'test-patient-1' };
                const updatedResource = { ...resource, name: [{ given: ['Updated'], family: 'Name' }] };
                mockMedplumClient.updateResource.mockResolvedValue(updatedResource);
                const result = await service.updateResource(resource);
                expect(mockMedplumClient.updateResource).toHaveBeenCalledWith(resource);
                expect(mockLogger.info).toHaveBeenCalledWith(`Successfully updated ${resource.resourceType} with ID: ${resource.id}`);
                expect(result).toEqual(updatedResource);
            });
            it('should throw error for resource without ID', async () => {
                const resource = global.createMockPatient();
                delete resource.id;
                await expect(service.updateResource(resource)).rejects.toThrow('Resource must have an ID to be updated');
                expect(mockMedplumClient.updateResource).not.toHaveBeenCalled();
            });
            it('should handle update errors', async () => {
                const resource = { ...global.createMockPatient(), id: 'test-patient-1' };
                const error = new Error('Update failed');
                mockMedplumClient.updateResource.mockRejectedValue(error);
                await expect(service.updateResource(resource)).rejects.toThrow('Update failed');
                expect(mockLogger.error).toHaveBeenCalledWith(`Failed to update ${resource.resourceType} resource:`, error);
            });
        });
        describe('deleteResource', () => {
            it('should delete a resource successfully', async () => {
                const resourceType = 'Patient';
                const resourceId = 'test-patient-1';
                mockMedplumClient.deleteResource.mockResolvedValue(undefined);
                await service.deleteResource(resourceType, resourceId);
                expect(mockMedplumClient.deleteResource).toHaveBeenCalledWith(resourceType, resourceId);
                expect(mockLogger.info).toHaveBeenCalledWith(`Successfully deleted ${resourceType} with ID: ${resourceId}`);
            });
            it('should handle delete errors', async () => {
                const resourceType = 'Patient';
                const resourceId = 'test-patient-1';
                const error = new Error('Delete failed');
                mockMedplumClient.deleteResource.mockRejectedValue(error);
                await expect(service.deleteResource(resourceType, resourceId)).rejects.toThrow('Delete failed');
                expect(mockLogger.error).toHaveBeenCalledWith(`Failed to delete ${resourceType} resource with ID ${resourceId}:`, error);
            });
        });
    });
    describe('Search Operations', () => {
        beforeEach(async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
        });
        it('should search resources successfully', async () => {
            const resourceType = 'Patient';
            const searchParams = { family: 'Doe', given: 'John' };
            const mockPatient = global.createMockPatient();
            // Mock searchResources to return ResourceArray structure
            const resourceArray = Object.assign([mockPatient], {
                bundle: {
                    resourceType: 'Bundle',
                    type: 'searchset',
                    total: 1,
                    entry: [{ resource: mockPatient }]
                }
            });
            mockMedplumClient.searchResources.mockResolvedValue(resourceArray);
            const result = await service.searchResources(resourceType, searchParams);
            expect(mockMedplumClient.searchResources).toHaveBeenCalledWith(resourceType, {
                family: 'Doe',
                given: 'John'
            });
            expect(result).toEqual({
                resourceType: 'Bundle',
                type: 'searchset',
                total: 1,
                entry: [{
                        resource: mockPatient,
                        fullUrl: `${mockPatient.resourceType}/${mockPatient.id}`
                    }]
            });
        });
        it('should handle search with special parameters', async () => {
            const resourceType = 'Patient';
            const searchParams = {
                family: 'Doe',
                _count: 10,
                _offset: 0,
                _sort: 'family:asc,given:desc',
                _include: 'Patient:general-practitioner',
                _revinclude: 'Encounter:patient',
                _elements: 'id,name,birthDate',
            };
            // Mock searchResources to return empty ResourceArray
            const emptyResourceArray = Object.assign([], {
                bundle: {
                    resourceType: 'Bundle',
                    type: 'searchset',
                    total: 0,
                    entry: []
                }
            });
            mockMedplumClient.searchResources.mockResolvedValue(emptyResourceArray);
            await service.searchResources(resourceType, searchParams);
            expect(mockMedplumClient.searchResources).toHaveBeenCalledWith(resourceType, {
                family: 'Doe',
                _count: 10,
                _offset: 0,
                _sort: 'family:asc,given:desc',
                _include: 'Patient:general-practitioner',
                _revinclude: 'Encounter:patient',
                _elements: 'id,name,birthDate'
            });
        });
        it('should handle search errors', async () => {
            const resourceType = 'Patient';
            const searchParams = { family: 'Doe' };
            const error = new Error('Search failed');
            mockMedplumClient.searchResources.mockRejectedValue(error);
            await expect(service.searchResources(resourceType, searchParams)).rejects.toThrow('Search failed');
            expect(mockLogger.error).toHaveBeenCalledWith(`Failed to search ${resourceType} resources:`, error);
        });
    });
    describe('Batch Operations', () => {
        beforeEach(async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
        });
        it('should execute batch bundle successfully', async () => {
            const bundleRequest = {
                resourceType: 'Bundle',
                type: 'batch',
                resources: [
                    global.createMockPatient(),
                    { ...global.createMockPatient(), id: 'existing-patient-1' },
                ],
                timestamp: '2024-01-01T12:00:00Z',
            };
            const batchResponse = {
                resourceType: 'Bundle',
                type: 'batch-response',
                entry: [
                    { response: { status: '201', location: 'Patient/new-patient-1' } },
                    { response: { status: '200', location: 'Patient/existing-patient-1' } },
                ],
            };
            mockMedplumClient.executeBatch.mockResolvedValue(batchResponse);
            const result = await service.executeBatch(bundleRequest);
            expect(mockMedplumClient.executeBatch).toHaveBeenCalledWith({
                resourceType: 'Bundle',
                type: 'batch',
                timestamp: '2024-01-01T12:00:00Z',
                entry: [
                    {
                        request: { method: 'POST', url: 'Patient' },
                        resource: bundleRequest.resources[0],
                    },
                    {
                        request: { method: 'PUT', url: 'Patient/existing-patient-1' },
                        resource: bundleRequest.resources[1],
                    },
                ],
            });
            expect(mockLogger.info).toHaveBeenCalledWith('Successfully executed batch bundle');
            expect(result).toEqual(batchResponse);
        });
        it('should handle batch execution errors', async () => {
            const bundleRequest = {
                resourceType: 'Bundle',
                type: 'batch',
                resources: [global.createMockPatient()],
            };
            const error = new Error('Batch execution failed');
            mockMedplumClient.executeBatch.mockRejectedValue(error);
            await expect(service.executeBatch(bundleRequest)).rejects.toThrow('Batch execution failed');
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to execute batch bundle:', error);
        });
    });
    describe('Utility Operations', () => {
        beforeEach(async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
        });
        it('should get capability statement', async () => {
            const capabilityStatement = {
                resourceType: 'CapabilityStatement',
                status: 'active',
                kind: 'instance',
            };
            mockMedplumClient.get.mockResolvedValue(capabilityStatement);
            const result = await service.getCapabilityStatement();
            expect(mockMedplumClient.get).toHaveBeenCalledWith('metadata');
            expect(result).toEqual(capabilityStatement);
        });
        it('should execute GraphQL query', async () => {
            const query = 'query { Patient { id name } }';
            const variables = { limit: 10 };
            const graphqlResponse = { data: { Patient: [] } };
            mockMedplumClient.graphql.mockResolvedValue(graphqlResponse);
            const result = await service.graphql(query, variables);
            expect(mockMedplumClient.graphql).toHaveBeenCalledWith(query, variables);
            expect(result).toEqual(graphqlResponse);
        });
        it('should validate resource', async () => {
            const resource = global.createMockPatient();
            const validationResult = {
                resourceType: 'OperationOutcome',
                issue: [],
            };
            mockMedplumClient.validateResource.mockResolvedValue(validationResult);
            const result = await service.validateResource(resource);
            expect(mockMedplumClient.validateResource).toHaveBeenCalledWith(resource);
            expect(result).toEqual(validationResult);
        });
        it('should create subscription', async () => {
            const criteria = 'Patient?active=true';
            const channelType = 'webhook';
            const endpoint = 'https://example.com/webhook';
            const subscription = {
                resourceType: 'Subscription',
                id: 'sub-123',
                status: 'active',
                reason: 'OmniCare EMR Integration',
                criteria,
                channel: {
                    type: channelType,
                    endpoint,
                    payload: 'application/fhir+json'
                },
            };
            mockMedplumClient.createResource.mockResolvedValue(subscription);
            const result = await service.createSubscription(criteria, channelType, endpoint);
            expect(mockMedplumClient.createResource).toHaveBeenCalledWith({
                resourceType: 'Subscription',
                status: 'requested',
                reason: 'OmniCare EMR Integration',
                criteria,
                channel: {
                    type: channelType,
                    endpoint,
                    payload: 'application/fhir+json',
                },
            });
            expect(result).toEqual(subscription);
        });
    });
    describe('Health Status', () => {
        it('should return DOWN status when not initialized', async () => {
            const result = await service.getHealthStatus();
            expect(result).toEqual({
                status: 'DOWN',
                details: { reason: 'Not initialized' },
            });
        });
        it('should return UP status when healthy', async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            mockMedplumClient.get.mockResolvedValue({ resourceType: 'CapabilityStatement' });
            await service.initialize();
            const result = await service.getHealthStatus();
            expect(result.status).toBe('UP');
            expect(result.details).toMatchObject({
                baseUrl: config_1.default.medplum.baseUrl,
                selfHosted: config_1.default.medplum.selfHosted,
                initialized: true,
            });
            expect(result.details.responseTime).toMatch(/\d+ms/);
        });
        it('should return DOWN status when unhealthy', async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
            const error = new Error('Service unavailable');
            mockMedplumClient.get.mockRejectedValue(error);
            const result = await service.getHealthStatus();
            expect(result).toEqual({
                status: 'DOWN',
                details: {
                    error: 'Service unavailable',
                    reconnectAttempts: 0,
                },
            });
        });
    });
    describe('Error Handling', () => {
        it('should throw error when not initialized', async () => {
            await expect(service.createResource(global.createMockPatient())).rejects.toThrow('MedplumService not initialized. Call initialize() first.');
        });
        it('should handle FHIR operation outcome in response data', async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
            const fhirError = {
                response: {
                    data: {
                        resourceType: 'OperationOutcome',
                        issue: [
                            {
                                severity: 'error',
                                code: 'invalid',
                                details: { text: 'Invalid resource format' },
                            },
                        ],
                    },
                },
            };
            mockMedplumClient.createResource.mockRejectedValue(fhirError);
            await expect(service.createResource(global.createMockPatient())).rejects.toThrow('FHIR Error: Invalid resource format');
        });
        it('should handle non-Error objects', async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
            mockMedplumClient.createResource.mockRejectedValue('String error');
            await expect(service.createResource(global.createMockPatient())).rejects.toThrow('String error');
        });
    });
    describe('Shutdown', () => {
        it('should shutdown service properly', async () => {
            const mockProfile = { resourceType: 'ProfileResource', id: 'profile-123' };
            mockMedplumClient.startClientLogin.mockResolvedValue(mockProfile);
            mockMedplumClient.readResource.mockRejectedValue(new Error('Not found'));
            await service.initialize();
            await service.shutdown();
            expect(mockLogger.info).toHaveBeenCalledWith('Shutting down Medplum service...');
            // Service should not be initialized after shutdown
            await expect(service.createResource(global.createMockPatient())).rejects.toThrow('MedplumService not initialized. Call initialize() first.');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3JvZHJpZ28vY2xhdWRlLXByb2plY3RzL09tbmlDYXJlL2JhY2tlbmQvdGVzdHMvdW5pdC9zZXJ2aWNlcy9tZWRwbHVtLnNlcnZpY2UudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUtBLG9CQUFvQjtBQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQUN2QyxJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDdEMsT0FBTyxFQUFFO1FBQ1AsT0FBTyxFQUFFLDBCQUEwQjtRQUNuQyxRQUFRLEVBQUUsZ0JBQWdCO1FBQzFCLFlBQVksRUFBRSxvQkFBb0I7UUFDbEMsU0FBUyxFQUFFLGlCQUFpQjtRQUM1QixVQUFVLEVBQUUsS0FBSztRQUNqQixhQUFhLEVBQUUsdUJBQXVCO0tBQ3ZDO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUFqQkosMkVBQXVFO0FBQ3ZFLHdDQUE4QztBQUM5Qyx1RUFBK0M7QUFDL0MsaUVBQXlDO0FBZ0J6QyxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO0lBQzlCLElBQUksT0FBdUIsQ0FBQztJQUM1QixJQUFJLGlCQUE2QyxDQUFDO0lBQ2xELE1BQU0sVUFBVSxHQUFHLGdCQUFvQyxDQUFDO0lBRXhELFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCx1Q0FBdUM7UUFDdkMsaUJBQWlCLEdBQUc7WUFDbEIsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUMzQixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN6QixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN2QixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN6QixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUN6QixlQUFlLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUMxQixZ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a2VuZC90ZXN0cy91bml0L3NlcnZpY2VzL21lZHBsdW0uc2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1lZHBsdW1TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzL21lZHBsdW0uc2VydmljZSc7XG5pbXBvcnQgeyBNZWRwbHVtQ2xpZW50IH0gZnJvbSAnQG1lZHBsdW0vY29yZSc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9sb2dnZXInO1xuaW1wb3J0IGNvbmZpZyBmcm9tICcuLi8uLi8uLi9zcmMvY29uZmlnJztcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnQG1lZHBsdW0vY29yZScpO1xuamVzdC5tb2NrKCcuLi8uLi8uLi9zcmMvdXRpbHMvbG9nZ2VyJyk7XG5qZXN0Lm1vY2soJy4uLy4uLy4uL3NyYy9jb25maWcnLCAoKSA9PiAoe1xuICBtZWRwbHVtOiB7XG4gICAgYmFzZVVybDogJ2h0dHBzOi8vYXBpLm1lZHBsdW0uY29tLycsXG4gICAgY2xpZW50SWQ6ICd0ZXN0LWNsaWVudC1pZCcsXG4gICAgY2xpZW50U2VjcmV0OiAndGVzdC1jbGllbnQtc2VjcmV0JyxcbiAgICBwcm9qZWN0SWQ6ICd0ZXN0LXByb2plY3QtaWQnLFxuICAgIHNlbGZIb3N0ZWQ6IGZhbHNlLFxuICAgIHNlbGZIb3N0ZWRVcmw6ICdodHRwOi8vbG9jYWxob3N0OjgxMDMnLFxuICB9LFxufSkpO1xuXG5kZXNjcmliZSgnTWVkcGx1bVNlcnZpY2UnLCAoKSA9PiB7XG4gIGxldCBzZXJ2aWNlOiBNZWRwbHVtU2VydmljZTtcbiAgbGV0IG1vY2tNZWRwbHVtQ2xpZW50OiBqZXN0Lk1vY2tlZDxNZWRwbHVtQ2xpZW50PjtcbiAgY29uc3QgbW9ja0xvZ2dlciA9IGxvZ2dlciBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgbG9nZ2VyPjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBDcmVhdGUgbW9jayBNZWRwbHVtQ2xpZW50IGluc3RhbmNlICBcbiAgICBtb2NrTWVkcGx1bUNsaWVudCA9IHtcbiAgICAgIHN0YXJ0Q2xpZW50TG9naW46IGplc3QuZm4oKSxcbiAgICAgIGNyZWF0ZVJlc291cmNlOiBqZXN0LmZuKCksXG4gICAgICByZWFkUmVzb3VyY2U6IGplc3QuZm4oKSxcbiAgICAgIHVwZGF0ZVJlc291cmNlOiBqZXN0LmZuKCksXG4gICAgICBkZWxldGVSZXNvdXJjZTogamVzdC5mbigpLFxuICAgICAgc2VhcmNoUmVzb3VyY2VzOiBqZXN0LmZuKCksXG4gICAgICBleGVjdXRlQmF0Y2g6IGplc3QuZm4oKSxcbiAgICAgIGdldDogamVzdC5mbigpLFxuICAgICAgZ3JhcGhxbDogamVzdC5mbigpLFxuICAgICAgdmFsaWRhdGVSZXNvdXJjZTogamVzdC5mbigpLFxuICAgIH0gYXMgYW55O1xuXG4gICAgLy8gTW9jayBNZWRwbHVtQ2xpZW50IGNvbnN0cnVjdG9yXG4gICAgKE1lZHBsdW1DbGllbnQgYXMgamVzdC5Nb2NrZWRDbGFzczx0eXBlb2YgTWVkcGx1bUNsaWVudD4pLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBtb2NrTWVkcGx1bUNsaWVudCk7XG5cbiAgICBzZXJ2aWNlID0gbmV3IE1lZHBsdW1TZXJ2aWNlKCk7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbml0aWFsaXphdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgd2l0aCBjb3JyZWN0IGNvbmZpZ3VyYXRpb24gZm9yIFNhYVMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZmlsZSA9IHsgcmVzb3VyY2VUeXBlOiAnUHJvZmlsZVJlc291cmNlJywgaWQ6ICdwcm9maWxlLTEyMycgfTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnN0YXJ0Q2xpZW50TG9naW4ubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2ZpbGUgYXMgYW55KTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05vdCBmb3VuZCcpKTsgLy8gRm9yIHRlc3QgY29ubmVjdGlvblxuXG4gICAgICBhd2FpdCBzZXJ2aWNlLmluaXRpYWxpemUoKTtcblxuICAgICAgZXhwZWN0KE1lZHBsdW1DbGllbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgYmFzZVVybDogY29uZmlnLm1lZHBsdW0uYmFzZVVybCxcbiAgICAgICAgY2xpZW50SWQ6IGNvbmZpZy5tZWRwbHVtLmNsaWVudElkLFxuICAgICAgICBmaGlyVXJsUGF0aDogJy9maGlyL1I0JyxcbiAgICAgICAgdG9rZW5Vcmw6IGAke2NvbmZpZy5tZWRwbHVtLmJhc2VVcmx9b2F1dGgyL3Rva2VuYCxcbiAgICAgICAgYXV0aG9yaXplVXJsOiBgJHtjb25maWcubWVkcGx1bS5iYXNlVXJsfW9hdXRoMi9hdXRob3JpemVgLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWVkcGx1bUNsaWVudC5zdGFydENsaWVudExvZ2luKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgY29uZmlnLm1lZHBsdW0uY2xpZW50SWQsXG4gICAgICAgIGNvbmZpZy5tZWRwbHVtLmNsaWVudFNlY3JldFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdNZWRwbHVtIEZISVIgc2VydmVyIGNvbm5lY3Rpb24gZXN0YWJsaXNoZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgd2l0aCBjb3JyZWN0IGNvbmZpZ3VyYXRpb24gZm9yIHNlbGYtaG9zdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzZWxmLWhvc3RlZCBjb25maWd1cmF0aW9uXG4gICAgICBjb25zdCBvcmlnaW5hbENvbmZpZyA9IHsgLi4uY29uZmlnLm1lZHBsdW0gfTtcbiAgICAgIGNvbmZpZy5tZWRwbHVtLnNlbGZIb3N0ZWQgPSB0cnVlO1xuXG4gICAgICBjb25zdCBtb2NrUHJvZmlsZSA9IHsgcmVzb3VyY2VUeXBlOiAnUHJvZmlsZVJlc291cmNlJywgaWQ6ICdwcm9maWxlLTEyMycgfTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnN0YXJ0Q2xpZW50TG9naW4ubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2ZpbGUgYXMgYW55KTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05vdCBmb3VuZCcpKTtcblxuICAgICAgYXdhaXQgc2VydmljZS5pbml0aWFsaXplKCk7XG5cbiAgICAgIGV4cGVjdChNZWRwbHVtQ2xpZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGJhc2VVcmw6IGNvbmZpZy5tZWRwbHVtLnNlbGZIb3N0ZWRVcmwsXG4gICAgICAgIGNsaWVudElkOiBjb25maWcubWVkcGx1bS5jbGllbnRJZCxcbiAgICAgICAgZmhpclVybFBhdGg6ICcvZmhpci9SNCcsXG4gICAgICAgIHRva2VuVXJsOiBgJHtjb25maWcubWVkcGx1bS5zZWxmSG9zdGVkVXJsfS9vYXV0aDIvdG9rZW5gLFxuICAgICAgICBhdXRob3JpemVVcmw6IGAke2NvbmZpZy5tZWRwbHVtLnNlbGZIb3N0ZWRVcmx9L29hdXRoMi9hdXRob3JpemVgLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgY29uZmlnXG4gICAgICBjb25maWcubWVkcGx1bSA9IG9yaWdpbmFsQ29uZmlnO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW5pdGlhbGl6YXRpb24gZmFpbHVyZSB3aXRoIHJldHJ5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0Nvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC5zdGFydENsaWVudExvZ2luLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gVXNlIGZha2UgdGltZXJzIHRvIGNvbnRyb2wgc2V0VGltZW91dFxuICAgICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGluaXRQcm9taXNlID0gc2VydmljZS5pbml0aWFsaXplKCk7XG4gICAgICBcbiAgICAgIC8vIEFkdmFuY2UgdGltZXJzIHRvIHRyaWdnZXIgcmV0cnlcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgyMDAwKTtcbiAgICAgIFxuICAgICAgLy8gU2Vjb25kIGF0dGVtcHQgc2hvdWxkIGFsc28gZmFpbFxuICAgICAgbW9ja01lZHBsdW1DbGllbnQuc3RhcnRDbGllbnRMb2dpbi5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG4gICAgICBcbiAgICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoaW5pdFByb21pc2UpLnJlamVjdHMudG9UaHJvdygnQ29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRmFpbGVkIHRvIGluaXRpYWxpemUgTWVkcGx1bSBjb25uZWN0aW9uOicsIGVycm9yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgYWZ0ZXIgbWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdQZXJzaXN0ZW50IGNvbm5lY3Rpb24gZmFpbHVyZScpO1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQuc3RhcnRDbGllbnRMb2dpbi5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIE1vY2sgbXVsdGlwbGUgZmFpbGVkIGF0dGVtcHRzXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykge1xuICAgICAgICBtb2NrTWVkcGx1bUNsaWVudC5zdGFydENsaWVudExvZ2luLm1vY2tSZWplY3RlZFZhbHVlT25jZShlcnJvcik7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmluaXRpYWxpemUoKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnRmFpbGVkIHRvIGVzdGFibGlzaCBNZWRwbHVtIGNvbm5lY3Rpb24gYWZ0ZXIgNSBhdHRlbXB0cydcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXNvdXJjZSBNYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gSW5pdGlhbGl6ZSBzZXJ2aWNlIGZvciByZXNvdXJjZSBtYW5hZ2VtZW50IHRlc3RzXG4gICAgICBjb25zdCBtb2NrUHJvZmlsZSA9IHsgcmVzb3VyY2VUeXBlOiAnUHJvZmlsZVJlc291cmNlJywgaWQ6ICdwcm9maWxlLTEyMycgfTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnN0YXJ0Q2xpZW50TG9naW4ubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2ZpbGUgYXMgYW55KTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05vdCBmb3VuZCcpKTtcbiAgICAgIGF3YWl0IHNlcnZpY2UuaW5pdGlhbGl6ZSgpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZVJlc291cmNlJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSByZXNvdXJjZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCk7XG4gICAgICAgIGNvbnN0IGNyZWF0ZWRSZXNvdXJjZSA9IHsgLi4ucmVzb3VyY2UsIGlkOiAnY3JlYXRlZC1wYXRpZW50LTEnIH07XG5cbiAgICAgICAgbW9ja01lZHBsdW1DbGllbnQuY3JlYXRlUmVzb3VyY2UubW9ja1Jlc29sdmVkVmFsdWUoY3JlYXRlZFJlc291cmNlKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVJlc291cmNlKHJlc291cmNlKTtcblxuICAgICAgICBleHBlY3QobW9ja01lZHBsdW1DbGllbnQuY3JlYXRlUmVzb3VyY2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJlc291cmNlKTtcbiAgICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgYFN1Y2Nlc3NmdWxseSBjcmVhdGVkICR7cmVzb3VyY2UucmVzb3VyY2VUeXBlfSB3aXRoIElEOiAke2NyZWF0ZWRSZXNvdXJjZS5pZH1gXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoY3JlYXRlZFJlc291cmNlKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjcmVhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCk7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdDcmVhdGlvbiBmYWlsZWQnKTtcblxuICAgICAgICBtb2NrTWVkcGx1bUNsaWVudC5jcmVhdGVSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuY3JlYXRlUmVzb3VyY2UocmVzb3VyY2UpKS5yZWplY3RzLnRvVGhyb3coJ0NyZWF0aW9uIGZhaWxlZCcpO1xuICAgICAgICBleHBlY3QobW9ja0xvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgYEZhaWxlZCB0byBjcmVhdGUgJHtyZXNvdXJjZS5yZXNvdXJjZVR5cGV9IHJlc291cmNlOmAsXG4gICAgICAgICAgZXJyb3JcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBGSElSIG9wZXJhdGlvbiBvdXRjb21lIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2UgPSAoZ2xvYmFsIGFzIGFueSkuY3JlYXRlTW9ja1BhdGllbnQoKTtcbiAgICAgICAgY29uc3QgZmhpckVycm9yID0ge1xuICAgICAgICAgIG91dGNvbWU6IHtcbiAgICAgICAgICAgIGlzc3VlOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICBjb2RlOiAncmVxdWlyZWQnLFxuICAgICAgICAgICAgICAgIGRpYWdub3N0aWNzOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZDogbmFtZScsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgbW9ja01lZHBsdW1DbGllbnQuY3JlYXRlUmVzb3VyY2UubW9ja1JlamVjdGVkVmFsdWUoZmhpckVycm9yKTtcblxuICAgICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5jcmVhdGVSZXNvdXJjZShyZXNvdXJjZSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgICAnRkhJUiBFcnJvcjogTWlzc2luZyByZXF1aXJlZCBmaWVsZDogbmFtZSdcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3JlYWRSZXNvdXJjZScsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgcmVhZCBhIHJlc291cmNlIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1BhdGllbnQnO1xuICAgICAgICBjb25zdCByZXNvdXJjZUlkID0gJ3Rlc3QtcGF0aWVudC0xJztcbiAgICAgICAgY29uc3QgcmVzb3VyY2UgPSAoZ2xvYmFsIGFzIGFueSkuY3JlYXRlTW9ja1BhdGllbnQoKTtcblxuICAgICAgICBtb2NrTWVkcGx1bUNsaWVudC5yZWFkUmVzb3VyY2UubW9ja1Jlc29sdmVkVmFsdWUocmVzb3VyY2UpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucmVhZFJlc291cmNlKHJlc291cmNlVHlwZSwgcmVzb3VyY2VJZCk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgocmVzb3VyY2VUeXBlLCByZXNvdXJjZUlkKTtcbiAgICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZGVidWcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIGBTdWNjZXNzZnVsbHkgcmV0cmlldmVkICR7cmVzb3VyY2VUeXBlfSB3aXRoIElEOiAke3Jlc291cmNlSWR9YFxuICAgICAgICApO1xuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHJlc291cmNlKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSByZWFkIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1BhdGllbnQnO1xuICAgICAgICBjb25zdCByZXNvdXJjZUlkID0gJ25vbi1leGlzdGVudC1wYXRpZW50JztcbiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1Jlc291cmNlIG5vdCBmb3VuZCcpO1xuXG4gICAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmVhZFJlc291cmNlKHJlc291cmNlVHlwZSwgcmVzb3VyY2VJZCkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgICAnUmVzb3VyY2Ugbm90IGZvdW5kJ1xuICAgICAgICApO1xuICAgICAgICBleHBlY3QobW9ja0xvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgYEZhaWxlZCB0byByZWFkICR7cmVzb3VyY2VUeXBlfSByZXNvdXJjZSB3aXRoIElEICR7cmVzb3VyY2VJZH06YCxcbiAgICAgICAgICBlcnJvclxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndXBkYXRlUmVzb3VyY2UnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHVwZGF0ZSBhIHJlc291cmNlIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2UgPSB7IC4uLihnbG9iYWwgYXMgYW55KS5jcmVhdGVNb2NrUGF0aWVudCgpLCBpZDogJ3Rlc3QtcGF0aWVudC0xJyB9O1xuICAgICAgICBjb25zdCB1cGRhdGVkUmVzb3VyY2UgPSB7IC4uLnJlc291cmNlLCBuYW1lOiBbeyBnaXZlbjogWydVcGRhdGVkJ10sIGZhbWlseTogJ05hbWUnIH1dIH07XG5cbiAgICAgICAgbW9ja01lZHBsdW1DbGllbnQudXBkYXRlUmVzb3VyY2UubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFJlc291cmNlKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwZGF0ZVJlc291cmNlKHJlc291cmNlKTtcblxuICAgICAgICBleHBlY3QobW9ja01lZHBsdW1DbGllbnQudXBkYXRlUmVzb3VyY2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJlc291cmNlKTtcbiAgICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgYFN1Y2Nlc3NmdWxseSB1cGRhdGVkICR7cmVzb3VyY2UucmVzb3VyY2VUeXBlfSB3aXRoIElEOiAke3Jlc291cmNlLmlkfWBcbiAgICAgICAgKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkUmVzb3VyY2UpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgZm9yIHJlc291cmNlIHdpdGhvdXQgSUQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCk7XG4gICAgICAgIGRlbGV0ZSByZXNvdXJjZS5pZDtcblxuICAgICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS51cGRhdGVSZXNvdXJjZShyZXNvdXJjZSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgICAnUmVzb3VyY2UgbXVzdCBoYXZlIGFuIElEIHRvIGJlIHVwZGF0ZWQnXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChtb2NrTWVkcGx1bUNsaWVudC51cGRhdGVSZXNvdXJjZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSB1cGRhdGUgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXNvdXJjZSA9IHsgLi4uKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCksIGlkOiAndGVzdC1wYXRpZW50LTEnIH07XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdVcGRhdGUgZmFpbGVkJyk7XG5cbiAgICAgICAgbW9ja01lZHBsdW1DbGllbnQudXBkYXRlUmVzb3VyY2UubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLnVwZGF0ZVJlc291cmNlKHJlc291cmNlKSkucmVqZWN0cy50b1Rocm93KCdVcGRhdGUgZmFpbGVkJyk7XG4gICAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICBgRmFpbGVkIHRvIHVwZGF0ZSAke3Jlc291cmNlLnJlc291cmNlVHlwZX0gcmVzb3VyY2U6YCxcbiAgICAgICAgICBlcnJvclxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZGVsZXRlUmVzb3VyY2UnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGRlbGV0ZSBhIHJlc291cmNlIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1BhdGllbnQnO1xuICAgICAgICBjb25zdCByZXNvdXJjZUlkID0gJ3Rlc3QtcGF0aWVudC0xJztcblxuICAgICAgICBtb2NrTWVkcGx1bUNsaWVudC5kZWxldGVSZXNvdXJjZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICAgIGF3YWl0IHNlcnZpY2UuZGVsZXRlUmVzb3VyY2UocmVzb3VyY2VUeXBlLCByZXNvdXJjZUlkKTtcblxuICAgICAgICBleHBlY3QobW9ja01lZHBsdW1DbGllbnQuZGVsZXRlUmVzb3VyY2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJlc291cmNlVHlwZSwgcmVzb3VyY2VJZCk7XG4gICAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIGBTdWNjZXNzZnVsbHkgZGVsZXRlZCAke3Jlc291cmNlVHlwZX0gd2l0aCBJRDogJHtyZXNvdXJjZUlkfWBcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBkZWxldGUgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXNvdXJjZVR5cGUgPSAnUGF0aWVudCc7XG4gICAgICAgIGNvbnN0IHJlc291cmNlSWQgPSAndGVzdC1wYXRpZW50LTEnO1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGVsZXRlIGZhaWxlZCcpO1xuXG4gICAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LmRlbGV0ZVJlc291cmNlLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5kZWxldGVSZXNvdXJjZShyZXNvdXJjZVR5cGUsIHJlc291cmNlSWQpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICAgJ0RlbGV0ZSBmYWlsZWQnXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICBgRmFpbGVkIHRvIGRlbGV0ZSAke3Jlc291cmNlVHlwZX0gcmVzb3VyY2Ugd2l0aCBJRCAke3Jlc291cmNlSWR9OmAsXG4gICAgICAgICAgZXJyb3JcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VhcmNoIE9wZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZmlsZSA9IHsgcmVzb3VyY2VUeXBlOiAnUHJvZmlsZVJlc291cmNlJywgaWQ6ICdwcm9maWxlLTEyMycgfTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnN0YXJ0Q2xpZW50TG9naW4ubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2ZpbGUgYXMgYW55KTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05vdCBmb3VuZCcpKTtcbiAgICAgIGF3YWl0IHNlcnZpY2UuaW5pdGlhbGl6ZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZWFyY2ggcmVzb3VyY2VzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc291cmNlVHlwZSA9ICdQYXRpZW50JztcbiAgICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHsgZmFtaWx5OiAnRG9lJywgZ2l2ZW46ICdKb2huJyB9O1xuICAgICAgY29uc3QgbW9ja1BhdGllbnQgPSAoZ2xvYmFsIGFzIGFueSkuY3JlYXRlTW9ja1BhdGllbnQoKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBzZWFyY2hSZXNvdXJjZXMgdG8gcmV0dXJuIFJlc291cmNlQXJyYXkgc3RydWN0dXJlXG4gICAgICBjb25zdCByZXNvdXJjZUFycmF5ID0gT2JqZWN0LmFzc2lnbihbbW9ja1BhdGllbnRdLCB7XG4gICAgICAgIGJ1bmRsZToge1xuICAgICAgICAgIHJlc291cmNlVHlwZTogJ0J1bmRsZScgYXMgY29uc3QsXG4gICAgICAgICAgdHlwZTogJ3NlYXJjaHNldCcgYXMgY29uc3QsXG4gICAgICAgICAgdG90YWw6IDEsXG4gICAgICAgICAgZW50cnk6IFt7IHJlc291cmNlOiBtb2NrUGF0aWVudCB9XVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja01lZHBsdW1DbGllbnQuc2VhcmNoUmVzb3VyY2VzLm1vY2tSZXNvbHZlZFZhbHVlKHJlc291cmNlQXJyYXkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnNlYXJjaFJlc291cmNlcyhyZXNvdXJjZVR5cGUsIHNlYXJjaFBhcmFtcyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWVkcGx1bUNsaWVudC5zZWFyY2hSZXNvdXJjZXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJlc291cmNlVHlwZSwge1xuICAgICAgICBmYW1pbHk6ICdEb2UnLFxuICAgICAgICBnaXZlbjogJ0pvaG4nXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHJlc291cmNlVHlwZTogJ0J1bmRsZScsXG4gICAgICAgIHR5cGU6ICdzZWFyY2hzZXQnLFxuICAgICAgICB0b3RhbDogMSxcbiAgICAgICAgZW50cnk6IFt7XG4gICAgICAgICAgcmVzb3VyY2U6IG1vY2tQYXRpZW50LFxuICAgICAgICAgIGZ1bGxVcmw6IGAke21vY2tQYXRpZW50LnJlc291cmNlVHlwZX0vJHttb2NrUGF0aWVudC5pZH1gXG4gICAgICAgIH1dXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlYXJjaCB3aXRoIHNwZWNpYWwgcGFyYW1ldGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc291cmNlVHlwZSA9ICdQYXRpZW50JztcbiAgICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHtcbiAgICAgICAgZmFtaWx5OiAnRG9lJyxcbiAgICAgICAgX2NvdW50OiAxMCxcbiAgICAgICAgX29mZnNldDogMCxcbiAgICAgICAgX3NvcnQ6ICdmYW1pbHk6YXNjLGdpdmVuOmRlc2MnLFxuICAgICAgICBfaW5jbHVkZTogJ1BhdGllbnQ6Z2VuZXJhbC1wcmFjdGl0aW9uZXInLFxuICAgICAgICBfcmV2aW5jbHVkZTogJ0VuY291bnRlcjpwYXRpZW50JyxcbiAgICAgICAgX2VsZW1lbnRzOiAnaWQsbmFtZSxiaXJ0aERhdGUnLFxuICAgICAgfTtcblxuICAgICAgLy8gTW9jayBzZWFyY2hSZXNvdXJjZXMgdG8gcmV0dXJuIGVtcHR5IFJlc291cmNlQXJyYXlcbiAgICAgIGNvbnN0IGVtcHR5UmVzb3VyY2VBcnJheSA9IE9iamVjdC5hc3NpZ24oW10sIHtcbiAgICAgICAgYnVuZGxlOiB7XG4gICAgICAgICAgcmVzb3VyY2VUeXBlOiAnQnVuZGxlJyBhcyBjb25zdCxcbiAgICAgICAgICB0eXBlOiAnc2VhcmNoc2V0JyBhcyBjb25zdCxcbiAgICAgICAgICB0b3RhbDogMCxcbiAgICAgICAgICBlbnRyeTogW11cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnNlYXJjaFJlc291cmNlcy5tb2NrUmVzb2x2ZWRWYWx1ZShlbXB0eVJlc291cmNlQXJyYXkpO1xuXG4gICAgICBhd2FpdCBzZXJ2aWNlLnNlYXJjaFJlc291cmNlcyhyZXNvdXJjZVR5cGUsIHNlYXJjaFBhcmFtcyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWVkcGx1bUNsaWVudC5zZWFyY2hSZXNvdXJjZXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJlc291cmNlVHlwZSwge1xuICAgICAgICBmYW1pbHk6ICdEb2UnLFxuICAgICAgICBfY291bnQ6IDEwLFxuICAgICAgICBfb2Zmc2V0OiAwLFxuICAgICAgICBfc29ydDogJ2ZhbWlseTphc2MsZ2l2ZW46ZGVzYycsXG4gICAgICAgIF9pbmNsdWRlOiAnUGF0aWVudDpnZW5lcmFsLXByYWN0aXRpb25lcicsXG4gICAgICAgIF9yZXZpbmNsdWRlOiAnRW5jb3VudGVyOnBhdGllbnQnLFxuICAgICAgICBfZWxlbWVudHM6ICdpZCxuYW1lLGJpcnRoRGF0ZSdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VhcmNoIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc291cmNlVHlwZSA9ICdQYXRpZW50JztcbiAgICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHsgZmFtaWx5OiAnRG9lJyB9O1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1NlYXJjaCBmYWlsZWQnKTtcblxuICAgICAgbW9ja01lZHBsdW1DbGllbnQuc2VhcmNoUmVzb3VyY2VzLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2Uuc2VhcmNoUmVzb3VyY2VzKHJlc291cmNlVHlwZSwgc2VhcmNoUGFyYW1zKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnU2VhcmNoIGZhaWxlZCdcbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBGYWlsZWQgdG8gc2VhcmNoICR7cmVzb3VyY2VUeXBlfSByZXNvdXJjZXM6YCxcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdCYXRjaCBPcGVyYXRpb25zJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Byb2ZpbGUgPSB7IHJlc291cmNlVHlwZTogJ1Byb2ZpbGVSZXNvdXJjZScsIGlkOiAncHJvZmlsZS0xMjMnIH07XG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC5zdGFydENsaWVudExvZ2luLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcm9maWxlIGFzIGFueSk7XG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC5yZWFkUmVzb3VyY2UubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOb3QgZm91bmQnKSk7XG4gICAgICBhd2FpdCBzZXJ2aWNlLmluaXRpYWxpemUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBiYXRjaCBidW5kbGUgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYnVuZGxlUmVxdWVzdCA9IHtcbiAgICAgICAgcmVzb3VyY2VUeXBlOiAnQnVuZGxlJyxcbiAgICAgICAgdHlwZTogJ2JhdGNoJyBhcyBjb25zdCxcbiAgICAgICAgcmVzb3VyY2VzOiBbXG4gICAgICAgICAgKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCksXG4gICAgICAgICAgeyAuLi4oZ2xvYmFsIGFzIGFueSkuY3JlYXRlTW9ja1BhdGllbnQoKSwgaWQ6ICdleGlzdGluZy1wYXRpZW50LTEnIH0sXG4gICAgICAgIF0sXG4gICAgICAgIHRpbWVzdGFtcDogJzIwMjQtMDEtMDFUMTI6MDA6MDBaJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGJhdGNoUmVzcG9uc2UgPSB7XG4gICAgICAgIHJlc291cmNlVHlwZTogJ0J1bmRsZScgYXMgY29uc3QsXG4gICAgICAgIHR5cGU6ICdiYXRjaC1yZXNwb25zZScgYXMgY29uc3QsXG4gICAgICAgIGVudHJ5OiBbXG4gICAgICAgICAgeyByZXNwb25zZTogeyBzdGF0dXM6ICcyMDEnLCBsb2NhdGlvbjogJ1BhdGllbnQvbmV3LXBhdGllbnQtMScgfSB9LFxuICAgICAgICAgIHsgcmVzcG9uc2U6IHsgc3RhdHVzOiAnMjAwJywgbG9jYXRpb246ICdQYXRpZW50L2V4aXN0aW5nLXBhdGllbnQtMScgfSB9LFxuICAgICAgICBdLFxuICAgICAgfTtcblxuICAgICAgbW9ja01lZHBsdW1DbGllbnQuZXhlY3V0ZUJhdGNoLm1vY2tSZXNvbHZlZFZhbHVlKGJhdGNoUmVzcG9uc2UpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmV4ZWN1dGVCYXRjaChidW5kbGVSZXF1ZXN0KTtcblxuICAgICAgZXhwZWN0KG1vY2tNZWRwbHVtQ2xpZW50LmV4ZWN1dGVCYXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICByZXNvdXJjZVR5cGU6ICdCdW5kbGUnLFxuICAgICAgICB0eXBlOiAnYmF0Y2gnLFxuICAgICAgICB0aW1lc3RhbXA6ICcyMDI0LTAxLTAxVDEyOjAwOjAwWicsXG4gICAgICAgIGVudHJ5OiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgcmVxdWVzdDogeyBtZXRob2Q6ICdQT1NUJywgdXJsOiAnUGF0aWVudCcgfSxcbiAgICAgICAgICAgIHJlc291cmNlOiBidW5kbGVSZXF1ZXN0LnJlc291cmNlc1swXSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJlcXVlc3Q6IHsgbWV0aG9kOiAnUFVUJywgdXJsOiAnUGF0aWVudC9leGlzdGluZy1wYXRpZW50LTEnIH0sXG4gICAgICAgICAgICByZXNvdXJjZTogYnVuZGxlUmVxdWVzdC5yZXNvdXJjZXNbMV0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1N1Y2Nlc3NmdWxseSBleGVjdXRlZCBiYXRjaCBidW5kbGUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoYmF0Y2hSZXNwb25zZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBiYXRjaCBleGVjdXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYnVuZGxlUmVxdWVzdCA9IHtcbiAgICAgICAgcmVzb3VyY2VUeXBlOiAnQnVuZGxlJyxcbiAgICAgICAgdHlwZTogJ2JhdGNoJyBhcyBjb25zdCxcbiAgICAgICAgcmVzb3VyY2VzOiBbKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCldLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0JhdGNoIGV4ZWN1dGlvbiBmYWlsZWQnKTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LmV4ZWN1dGVCYXRjaC5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmV4ZWN1dGVCYXRjaChidW5kbGVSZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnQmF0Y2ggZXhlY3V0aW9uIGZhaWxlZCdcbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0ZhaWxlZCB0byBleGVjdXRlIGJhdGNoIGJ1bmRsZTonLCBlcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVdGlsaXR5IE9wZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZmlsZSA9IHsgcmVzb3VyY2VUeXBlOiAnUHJvZmlsZVJlc291cmNlJywgaWQ6ICdwcm9maWxlLTEyMycgfTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnN0YXJ0Q2xpZW50TG9naW4ubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2ZpbGUgYXMgYW55KTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05vdCBmb3VuZCcpKTtcbiAgICAgIGF3YWl0IHNlcnZpY2UuaW5pdGlhbGl6ZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgY2FwYWJpbGl0eSBzdGF0ZW1lbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjYXBhYmlsaXR5U3RhdGVtZW50ID0ge1xuICAgICAgICByZXNvdXJjZVR5cGU6ICdDYXBhYmlsaXR5U3RhdGVtZW50JyxcbiAgICAgICAgc3RhdHVzOiAnYWN0aXZlJyxcbiAgICAgICAga2luZDogJ2luc3RhbmNlJyxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LmdldC5tb2NrUmVzb2x2ZWRWYWx1ZShjYXBhYmlsaXR5U3RhdGVtZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXRDYXBhYmlsaXR5U3RhdGVtZW50KCk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWVkcGx1bUNsaWVudC5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdtZXRhZGF0YScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChjYXBhYmlsaXR5U3RhdGVtZW50KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBHcmFwaFFMIHF1ZXJ5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSAncXVlcnkgeyBQYXRpZW50IHsgaWQgbmFtZSB9IH0nO1xuICAgICAgY29uc3QgdmFyaWFibGVzID0geyBsaW1pdDogMTAgfTtcbiAgICAgIGNvbnN0IGdyYXBocWxSZXNwb25zZSA9IHsgZGF0YTogeyBQYXRpZW50OiBbXSB9IH07XG5cbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LmdyYXBocWwubW9ja1Jlc29sdmVkVmFsdWUoZ3JhcGhxbFJlc3BvbnNlKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5ncmFwaHFsKHF1ZXJ5LCB2YXJpYWJsZXMpO1xuXG4gICAgICBleHBlY3QobW9ja01lZHBsdW1DbGllbnQuZ3JhcGhxbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgocXVlcnksIHZhcmlhYmxlcyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGdyYXBocWxSZXNwb25zZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHJlc291cmNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzb3VyY2UgPSAoZ2xvYmFsIGFzIGFueSkuY3JlYXRlTW9ja1BhdGllbnQoKTtcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSB7XG4gICAgICAgIHJlc291cmNlVHlwZTogJ09wZXJhdGlvbk91dGNvbWUnIGFzIGNvbnN0LFxuICAgICAgICBpc3N1ZTogW10sXG4gICAgICB9O1xuXG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC52YWxpZGF0ZVJlc291cmNlLm1vY2tSZXNvbHZlZFZhbHVlKHZhbGlkYXRpb25SZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnZhbGlkYXRlUmVzb3VyY2UocmVzb3VyY2UpO1xuXG4gICAgICBleHBlY3QobW9ja01lZHBsdW1DbGllbnQudmFsaWRhdGVSZXNvdXJjZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgocmVzb3VyY2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh2YWxpZGF0aW9uUmVzdWx0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIHN1YnNjcmlwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNyaXRlcmlhID0gJ1BhdGllbnQ/YWN0aXZlPXRydWUnO1xuICAgICAgY29uc3QgY2hhbm5lbFR5cGUgPSAnd2ViaG9vayc7XG4gICAgICBjb25zdCBlbmRwb2ludCA9ICdodHRwczovL2V4YW1wbGUuY29tL3dlYmhvb2snO1xuXG4gICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB7XG4gICAgICAgIHJlc291cmNlVHlwZTogJ1N1YnNjcmlwdGlvbicgYXMgY29uc3QsXG4gICAgICAgIGlkOiAnc3ViLTEyMycsXG4gICAgICAgIHN0YXR1czogJ2FjdGl2ZScgYXMgY29uc3QsXG4gICAgICAgIHJlYXNvbjogJ09tbmlDYXJlIEVNUiBJbnRlZ3JhdGlvbicsXG4gICAgICAgIGNyaXRlcmlhLFxuICAgICAgICBjaGFubmVsOiB7IFxuICAgICAgICAgIHR5cGU6IGNoYW5uZWxUeXBlIGFzICdyZXN0LWhvb2snLFxuICAgICAgICAgIGVuZHBvaW50LFxuICAgICAgICAgIHBheWxvYWQ6ICdhcHBsaWNhdGlvbi9maGlyK2pzb24nXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC5jcmVhdGVSZXNvdXJjZS5tb2NrUmVzb2x2ZWRWYWx1ZShzdWJzY3JpcHRpb24gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVTdWJzY3JpcHRpb24oY3JpdGVyaWEsIGNoYW5uZWxUeXBlLCBlbmRwb2ludCk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWVkcGx1bUNsaWVudC5jcmVhdGVSZXNvdXJjZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICByZXNvdXJjZVR5cGU6ICdTdWJzY3JpcHRpb24nLFxuICAgICAgICBzdGF0dXM6ICdyZXF1ZXN0ZWQnLFxuICAgICAgICByZWFzb246ICdPbW5pQ2FyZSBFTVIgSW50ZWdyYXRpb24nLFxuICAgICAgICBjcml0ZXJpYSxcbiAgICAgICAgY2hhbm5lbDoge1xuICAgICAgICAgIHR5cGU6IGNoYW5uZWxUeXBlLFxuICAgICAgICAgIGVuZHBvaW50LFxuICAgICAgICAgIHBheWxvYWQ6ICdhcHBsaWNhdGlvbi9maGlyK2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHN1YnNjcmlwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdIZWFsdGggU3RhdHVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIERPV04gc3RhdHVzIHdoZW4gbm90IGluaXRpYWxpemVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXRIZWFsdGhTdGF0dXMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHN0YXR1czogJ0RPV04nLFxuICAgICAgICBkZXRhaWxzOiB7IHJlYXNvbjogJ05vdCBpbml0aWFsaXplZCcgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gVVAgc3RhdHVzIHdoZW4gaGVhbHRoeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9maWxlID0geyByZXNvdXJjZVR5cGU6ICdQcm9maWxlUmVzb3VyY2UnLCBpZDogJ3Byb2ZpbGUtMTIzJyB9O1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQuc3RhcnRDbGllbnRMb2dpbi5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZmlsZSBhcyBhbnkpO1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQucmVhZFJlc291cmNlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTm90IGZvdW5kJykpO1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHsgcmVzb3VyY2VUeXBlOiAnQ2FwYWJpbGl0eVN0YXRlbWVudCcgfSk7XG5cbiAgICAgIGF3YWl0IHNlcnZpY2UuaW5pdGlhbGl6ZSgpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXRIZWFsdGhTdGF0dXMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoJ1VQJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmRldGFpbHMpLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgICBiYXNlVXJsOiBjb25maWcubWVkcGx1bS5iYXNlVXJsLFxuICAgICAgICBzZWxmSG9zdGVkOiBjb25maWcubWVkcGx1bS5zZWxmSG9zdGVkLFxuICAgICAgICBpbml0aWFsaXplZDogdHJ1ZSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5kZXRhaWxzLnJlc3BvbnNlVGltZSkudG9NYXRjaCgvXFxkK21zLyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBET1dOIHN0YXR1cyB3aGVuIHVuaGVhbHRoeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9maWxlID0geyByZXNvdXJjZVR5cGU6ICdQcm9maWxlUmVzb3VyY2UnLCBpZDogJ3Byb2ZpbGUtMTIzJyB9O1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQuc3RhcnRDbGllbnRMb2dpbi5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZmlsZSBhcyBhbnkpO1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQucmVhZFJlc291cmNlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTm90IGZvdW5kJykpO1xuICAgICAgYXdhaXQgc2VydmljZS5pbml0aWFsaXplKCk7XG5cbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdTZXJ2aWNlIHVuYXZhaWxhYmxlJyk7XG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC5nZXQubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldEhlYWx0aFN0YXR1cygpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgc3RhdHVzOiAnRE9XTicsXG4gICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICBlcnJvcjogJ1NlcnZpY2UgdW5hdmFpbGFibGUnLFxuICAgICAgICAgIHJlY29ubmVjdEF0dGVtcHRzOiAwLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gbm90IGluaXRpYWxpemVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuY3JlYXRlUmVzb3VyY2UoKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCkpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdNZWRwbHVtU2VydmljZSBub3QgaW5pdGlhbGl6ZWQuIENhbGwgaW5pdGlhbGl6ZSgpIGZpcnN0LidcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBGSElSIG9wZXJhdGlvbiBvdXRjb21lIGluIHJlc3BvbnNlIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZmlsZSA9IHsgcmVzb3VyY2VUeXBlOiAnUHJvZmlsZVJlc291cmNlJywgaWQ6ICdwcm9maWxlLTEyMycgfTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnN0YXJ0Q2xpZW50TG9naW4ubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2ZpbGUgYXMgYW55KTtcbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LnJlYWRSZXNvdXJjZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05vdCBmb3VuZCcpKTtcbiAgICAgIGF3YWl0IHNlcnZpY2UuaW5pdGlhbGl6ZSgpO1xuXG4gICAgICBjb25zdCBmaGlyRXJyb3IgPSB7XG4gICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgcmVzb3VyY2VUeXBlOiAnT3BlcmF0aW9uT3V0Y29tZScsXG4gICAgICAgICAgICBpc3N1ZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgY29kZTogJ2ludmFsaWQnLFxuICAgICAgICAgICAgICAgIGRldGFpbHM6IHsgdGV4dDogJ0ludmFsaWQgcmVzb3VyY2UgZm9ybWF0JyB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgbW9ja01lZHBsdW1DbGllbnQuY3JlYXRlUmVzb3VyY2UubW9ja1JlamVjdGVkVmFsdWUoZmhpckVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuY3JlYXRlUmVzb3VyY2UoKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCkpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdGSElSIEVycm9yOiBJbnZhbGlkIHJlc291cmNlIGZvcm1hdCdcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBub24tRXJyb3Igb2JqZWN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9maWxlID0geyByZXNvdXJjZVR5cGU6ICdQcm9maWxlUmVzb3VyY2UnLCBpZDogJ3Byb2ZpbGUtMTIzJyB9O1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQuc3RhcnRDbGllbnRMb2dpbi5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZmlsZSBhcyBhbnkpO1xuICAgICAgbW9ja01lZHBsdW1DbGllbnQucmVhZFJlc291cmNlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTm90IGZvdW5kJykpO1xuICAgICAgYXdhaXQgc2VydmljZS5pbml0aWFsaXplKCk7XG5cbiAgICAgIG1vY2tNZWRwbHVtQ2xpZW50LmNyZWF0ZVJlc291cmNlLm1vY2tSZWplY3RlZFZhbHVlKCdTdHJpbmcgZXJyb3InKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuY3JlYXRlUmVzb3VyY2UoKGdsb2JhbCBhcyBhbnkpLmNyZWF0ZU1vY2tQYXRpZW50KCkpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdTdHJpbmcgZXJyb3InXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2h1dGRvd24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzaHV0ZG93biBzZXJ2aWNlIHByb3Blcmx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Byb2ZpbGUgPSB7IHJlc291cmNlVHlwZTogJ1Byb2ZpbGVSZXNvdXJjZScsIGlkOiAncHJvZmlsZS0xMjMnIH07XG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC5zdGFydENsaWVudExvZ2luLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcm9maWxlIGFzIGFueSk7XG4gICAgICBtb2NrTWVkcGx1bUNsaWVudC5yZWFkUmVzb3VyY2UubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOb3QgZm91bmQnKSk7XG4gICAgICBhd2FpdCBzZXJ2aWNlLmluaXRpYWxpemUoKTtcblxuICAgICAgYXdhaXQgc2VydmljZS5zaHV0ZG93bigpO1xuXG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5pbmZvKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnU2h1dHRpbmcgZG93biBNZWRwbHVtIHNlcnZpY2UuLi4nKTtcbiAgICAgIFxuICAgICAgLy8gU2VydmljZSBzaG91bGQgbm90IGJlIGluaXRpYWxpemVkIGFmdGVyIHNodXRkb3duXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5jcmVhdGVSZXNvdXJjZSgoZ2xvYmFsIGFzIGFueSkuY3JlYXRlTW9ja1BhdGllbnQoKSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgJ01lZHBsdW1TZXJ2aWNlIG5vdCBpbml0aWFsaXplZC4gQ2FsbCBpbml0aWFsaXplKCkgZmlyc3QuJ1xuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=