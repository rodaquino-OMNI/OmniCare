66e09e856f3fb52248dbef9aff531bf4
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('jsonwebtoken');
jest.mock('../../../src/config', () => ({
    jwt: {
        secret: 'test-jwt-secret',
        expiresIn: '1h'
    }
}));
jest.mock('../../../src/utils/logger');
const jsonwebtoken_1 = __importDefault(require("jsonwebtoken"));
const auth_middleware_1 = require("../../../src/middleware/auth.middleware");
const config_1 = __importDefault(require("../../../src/config"));
const logger_1 = __importDefault(require("../../../src/utils/logger"));
describe('Auth Middleware', () => {
    let mockRequest;
    let mockResponse;
    let mockNext;
    const mockJwt = jsonwebtoken_1.default;
    const mockLogger = logger_1.default;
    beforeEach(() => {
        mockRequest = {
            headers: {},
            user: undefined
        };
        mockResponse = {
            status: jest.fn().mockReturnThis(),
            json: jest.fn().mockReturnThis(),
            set: jest.fn().mockReturnThis()
        };
        mockNext = jest.fn();
        jest.clearAllMocks();
    });
    describe('authMiddleware', () => {
        it('should authenticate user with valid JWT token', async () => {
            const validToken = 'valid.jwt.token';
            const decodedPayload = {
                sub: 'user-123',
                username: 'testuser',
                role: 'physician',
                permissions: ['patient:read', 'patient:write'],
                type: 'access',
                iss: 'omnicare',
                aud: 'omnicare-api',
                exp: Math.floor(Date.now() / 1000) + 3600,
                iat: Math.floor(Date.now() / 1000)
            };
            mockRequest.headers = {
                authorization: `Bearer ${validToken}`
            };
            mockJwt.verify.mockReturnValue(decodedPayload);
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockJwt.verify).toHaveBeenCalledWith(validToken, config_1.default.jwt.secret);
            expect(mockRequest.user).toEqual({
                id: decodedPayload.sub,
                username: decodedPayload.username,
                role: decodedPayload.role,
                permissions: decodedPayload.permissions,
                tokenType: decodedPayload.type
            });
            expect(mockNext).toHaveBeenCalledWith();
        });
        it('should authenticate user with valid JWT token in query parameter', async () => {
            const validToken = 'valid.jwt.token';
            const decodedPayload = {
                sub: 'user-123',
                username: 'testuser',
                role: 'nurse',
                permissions: ['patient:read'],
                type: 'access'
            };
            mockRequest.query = {
                access_token: validToken
            };
            mockJwt.verify.mockReturnValue(decodedPayload);
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockJwt.verify).toHaveBeenCalledWith(validToken, config_1.default.jwt.secret);
            expect(mockRequest.user).toBeDefined();
            expect(mockNext).toHaveBeenCalledWith();
        });
        it('should reject request with no authorization token', async () => {
            mockRequest.headers = {};
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'No authorization token provided'
            });
            expect(mockNext).not.toHaveBeenCalled();
        });
        it('should reject request with malformed authorization header', async () => {
            mockRequest.headers = {
                authorization: 'InvalidFormat token'
            };
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Invalid authorization header format'
            });
        });
        it('should reject request with invalid JWT token', async () => {
            const invalidToken = 'invalid.jwt.token';
            mockRequest.headers = {
                authorization: `Bearer ${invalidToken}`
            };
            mockJwt.verify.mockImplementation(() => {
                throw new jsonwebtoken_1.default.JsonWebTokenError('invalid token');
            });
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Invalid token'
            });
            expect(mockLogger.security).toHaveBeenCalledWith('Invalid JWT token attempted', expect.objectContaining({
                error: 'invalid token'
            }));
        });
        it('should reject expired JWT token', async () => {
            const expiredToken = 'expired.jwt.token';
            mockRequest.headers = {
                authorization: `Bearer ${expiredToken}`
            };
            mockJwt.verify.mockImplementation(() => {
                throw new jsonwebtoken_1.default.TokenExpiredError('jwt expired', new Date());
            });
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'token_expired',
                message: 'Token has expired'
            });
        });
        it('should reject token with invalid signature', async () => {
            const tokenWithInvalidSignature = 'token.with.invalid.signature';
            mockRequest.headers = {
                authorization: `Bearer ${tokenWithInvalidSignature}`
            };
            mockJwt.verify.mockImplementation(() => {
                throw new jsonwebtoken_1.default.JsonWebTokenError('invalid signature');
            });
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Invalid token'
            });
        });
        it('should reject token with wrong token type', async () => {
            const refreshToken = 'refresh.token.type';
            const decodedPayload = {
                sub: 'user-123',
                username: 'testuser',
                type: 'refresh' // Wrong type for API access
            };
            mockRequest.headers = {
                authorization: `Bearer ${refreshToken}`
            };
            mockJwt.verify.mockReturnValue(decodedPayload);
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Invalid token type for API access'
            });
        });
        it('should handle JWT verification errors gracefully', async () => {
            const malformedToken = 'malformed.jwt';
            mockRequest.headers = {
                authorization: `Bearer ${malformedToken}`
            };
            mockJwt.verify.mockImplementation(() => {
                throw new Error('Unexpected error during verification');
            });
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Token verification failed'
            });
        });
        it('should log security events for failed authentication', async () => {
            mockRequest.headers = {
                authorization: 'Bearer invalid.token'
            };
            mockRequest.ip = '192.168.1.100';
            mockRequest.get = jest.fn().mockReturnValue('Mozilla/5.0');
            mockJwt.verify.mockImplementation(() => {
                throw new jsonwebtoken_1.default.JsonWebTokenError('invalid token');
            });
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockLogger.security).toHaveBeenCalledWith('Invalid JWT token attempted', expect.objectContaining({
                ip: '192.168.1.100',
                userAgent: 'Mozilla/5.0',
                error: 'invalid token'
            }));
        });
    });
    describe('requirePermissions middleware', () => {
        beforeEach(() => {
            mockRequest.user = {
                id: 'user-123',
                username: 'testuser',
                role: 'physician',
                permissions: ['patient:read', 'patient:write', 'encounter:read']
            };
        });
        it('should allow access with required permissions', async () => {
            const middleware = (0, auth_middleware_1.requirePermissions)(['patient:read']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockNext).toHaveBeenCalledWith();
        });
        it('should allow access with multiple required permissions', async () => {
            const middleware = (0, auth_middleware_1.requirePermissions)(['patient:read', 'encounter:read']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockNext).toHaveBeenCalledWith();
        });
        it('should deny access without required permissions', async () => {
            const middleware = (0, auth_middleware_1.requirePermissions)(['admin:write']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(403);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'forbidden',
                message: 'Insufficient permissions',
                required: ['admin:write'],
                missing: ['admin:write']
            });
            expect(mockNext).not.toHaveBeenCalled();
        });
        it('should deny access with partial permissions', async () => {
            const middleware = (0, auth_middleware_1.requirePermissions)(['patient:read', 'admin:write']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(403);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'forbidden',
                message: 'Insufficient permissions',
                required: ['patient:read', 'admin:write'],
                missing: ['admin:write']
            });
        });
        it('should handle user without permissions array', async () => {
            mockRequest.user = {
                id: 'user-123',
                username: 'testuser',
                role: 'guest'
                // No permissions array
            };
            const middleware = (0, auth_middleware_1.requirePermissions)(['patient:read']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(403);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'forbidden',
                message: 'Insufficient permissions',
                required: ['patient:read'],
                missing: ['patient:read']
            });
        });
        it('should handle unauthenticated user', async () => {
            mockRequest.user = undefined;
            const middleware = (0, auth_middleware_1.requirePermissions)(['patient:read']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Authentication required'
            });
        });
        it('should log permission denied events', async () => {
            const middleware = (0, auth_middleware_1.requirePermissions)(['admin:delete']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockLogger.security).toHaveBeenCalledWith('Permission denied', expect.objectContaining({
                userId: 'user-123',
                username: 'testuser',
                role: 'physician',
                requiredPermissions: ['admin:delete'],
                userPermissions: ['patient:read', 'patient:write', 'encounter:read']
            }));
        });
    });
    describe('requireRole middleware', () => {
        beforeEach(() => {
            mockRequest.user = {
                id: 'user-123',
                username: 'testuser',
                role: 'physician',
                permissions: ['patient:read', 'patient:write']
            };
        });
        it('should allow access with required role', async () => {
            const middleware = (0, auth_middleware_1.requireRole)(['physician']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockNext).toHaveBeenCalledWith();
        });
        it('should allow access with one of multiple required roles', async () => {
            const middleware = (0, auth_middleware_1.requireRole)(['physician', 'nurse']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockNext).toHaveBeenCalledWith();
        });
        it('should deny access without required role', async () => {
            const middleware = (0, auth_middleware_1.requireRole)(['admin']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(403);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'forbidden',
                message: 'Insufficient role privileges',
                required: ['admin'],
                current: 'physician'
            });
        });
        it('should handle unauthenticated user', async () => {
            mockRequest.user = undefined;
            const middleware = (0, auth_middleware_1.requireRole)(['physician']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Authentication required'
            });
        });
        it('should handle user without role', async () => {
            mockRequest.user = {
                id: 'user-123',
                username: 'testuser'
                // No role property
            };
            const middleware = (0, auth_middleware_1.requireRole)(['physician']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(403);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'forbidden',
                message: 'Insufficient role privileges',
                required: ['physician'],
                current: undefined
            });
        });
        it('should log role access denied events', async () => {
            const middleware = (0, auth_middleware_1.requireRole)(['admin']);
            await middleware(mockRequest, mockResponse, mockNext);
            expect(mockLogger.security).toHaveBeenCalledWith('Role access denied', expect.objectContaining({
                userId: 'user-123',
                username: 'testuser',
                currentRole: 'physician',
                requiredRoles: ['admin']
            }));
        });
    });
    describe('Edge Cases and Security', () => {
        it('should handle very long authorization headers', async () => {
            const veryLongToken = 'Bearer ' + 'a'.repeat(10000);
            mockRequest.headers = {
                authorization: veryLongToken
            };
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
            expect(mockResponse.json).toHaveBeenCalledWith({
                error: 'unauthorized',
                message: 'Token verification failed'
            });
        });
        it('should handle special characters in token', async () => {
            const tokenWithSpecialChars = 'token.with.special!@#$%^&*()chars';
            mockRequest.headers = {
                authorization: `Bearer ${tokenWithSpecialChars}`
            };
            mockJwt.verify.mockImplementation(() => {
                throw new jsonwebtoken_1.default.JsonWebTokenError('invalid token');
            });
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            expect(mockResponse.status).toHaveBeenCalledWith(401);
        });
        it('should prevent privilege escalation attempts', async () => {
            const maliciousPayload = {
                sub: 'user-123',
                username: 'testuser',
                role: 'admin', // Attempting to escalate to admin
                permissions: ['admin:write', 'system:delete'], // Malicious permissions
                type: 'access'
            };
            const maliciousToken = 'malicious.token';
            mockRequest.headers = {
                authorization: `Bearer ${maliciousToken}`
            };
            // Even if token is somehow valid, it should be from trusted source
            mockJwt.verify.mockReturnValue(maliciousPayload);
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            // Should authenticate normally - privilege verification happens at permission/role level
            expect(mockRequest.user).toEqual({
                id: maliciousPayload.sub,
                username: maliciousPayload.username,
                role: maliciousPayload.role,
                permissions: maliciousPayload.permissions,
                tokenType: maliciousPayload.type
            });
            expect(mockNext).toHaveBeenCalledWith();
        });
        it('should rate limit authentication attempts', async () => {
            // This would typically be handled by rate limiting middleware
            // But we can test that multiple failed attempts are logged
            mockRequest.headers = {
                authorization: 'Bearer invalid.token'
            };
            mockRequest.ip = '192.168.1.100';
            mockJwt.verify.mockImplementation(() => {
                throw new jsonwebtoken_1.default.JsonWebTokenError('invalid token');
            });
            // Simulate multiple attempts
            for (let i = 0; i < 5; i++) {
                await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            }
            expect(mockLogger.security).toHaveBeenCalledTimes(5);
        });
        it('should handle token injection attempts', async () => {
            mockRequest.headers = {
                authorization: 'Bearer token1',
                'x-access-token': 'token2'
            };
            mockRequest.query = {
                access_token: 'token3'
            };
            mockJwt.verify.mockImplementation(() => {
                throw new jsonwebtoken_1.default.JsonWebTokenError('invalid token');
            });
            await (0, auth_middleware_1.authMiddleware)(mockRequest, mockResponse, mockNext);
            // Should only try to verify the Authorization header token
            expect(mockJwt.verify).toHaveBeenCalledTimes(1);
            expect(mockJwt.verify).toHaveBeenCalledWith('token1', config_1.default.jwt.secret);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3JvZHJpZ28vY2xhdWRlLXByb2plY3RzL09tbmlDYXJlL2JhY2tlbmQvdGVzdHMvdW5pdC9taWRkbGV3YXJlL2F1dGgubWlkZGxld2FyZS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBTUEsb0JBQW9CO0FBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDMUIsSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLEdBQUcsRUFBRTtRQUNILE1BQU0sRUFBRSxpQkFBaUI7UUFDekIsU0FBUyxFQUFFLElBQUk7S0FDaEI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUNKLElBQUksQ0FBQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQWJ2QyxnRUFBK0I7QUFDL0IsNkVBQTBHO0FBQzFHLGlFQUF5QztBQUN6Qyx1RUFBK0M7QUFZL0MsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtJQUMvQixJQUFJLFdBQTZCLENBQUM7SUFDbEMsSUFBSSxZQUErQixDQUFDO0lBQ3BDLElBQUksUUFBc0IsQ0FBQztJQUUzQixNQUFNLE9BQU8sR0FBRyxzQkFBOEIsQ0FBQztJQUMvQyxNQUFNLFVBQVUsR0FBRyxnQkFBb0MsQ0FBQztJQUV4RCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsV0FBVyxHQUFHO1lBQ1osT0FBTyxFQUFFLEVBQUU7WUFDWCxJQUFJLEVBQUUsU0FBUztTQUNoQixDQUFDO1FBRUYsWUFBWSxHQUFHO1lBQ2IsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7WUFDbEMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7WUFDaEMsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7U0FDaEMsQ0FBQztRQUVGLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7UUFFckIsSUFB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RyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDM0IsTUFBTSxJQUFBLGdDQUFjLEVBQ2xCLFdBQXNCLEVBQ3RCLFlBQXdCLEVBQ3hCLFFBQVEsQ0FDVCxDQUFDO1lBQ0osQ0FBQztZQUVELE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0NBQXdDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdEQsV0FBVyxDQUFDLE9BQU8sR0FBRztnQkFDcEIsYUFBYSxFQUFFLGVBQWU7Z0JBQzlCLGdCQUFnQixFQUFFLFFBQVE7YUFDM0IsQ0FBQztZQUNGLFdBQVcsQ0FBQyxLQUFLLEdBQUc7Z0JBQ2xCLFlBQVksRUFBRSxRQUFRO2FBQ3ZCLENBQUM7WUFFRixPQUFPLENBQUMsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRTtnQkFDckMsTUFBTSxJQUFJLHNCQUFHLENBQUMsaUJBQWlCLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDbkQsQ0FBQyxDQUFDLENBQUM7WUFFSCxNQUFNLElBQUEsZ0NBQWMsRUFDbEIsV0FBc0IsRUFDdEIsWUFBd0IsRUFDeEIsUUFBUSxDQUNULENBQUM7WUFFRiwyREFBMkQ7WUFDM0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFFBQVEsRUFBRSxnQkFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMzRSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ28vY2xhdWRlLXByb2plY3RzL09tbmlDYXJlL2JhY2tlbmQvdGVzdHMvdW5pdC9taWRkbGV3YXJlL2F1dGgubWlkZGxld2FyZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCB7IGF1dGhNaWRkbGV3YXJlLCByZXF1aXJlUGVybWlzc2lvbnMsIHJlcXVpcmVSb2xlIH0gZnJvbSAnLi4vLi4vLi4vc3JjL21pZGRsZXdhcmUvYXV0aC5taWRkbGV3YXJlJztcbmltcG9ydCBjb25maWcgZnJvbSAnLi4vLi4vLi4vc3JjL2NvbmZpZyc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJy4uLy4uLy4uL3NyYy91dGlscy9sb2dnZXInO1xuXG4vLyBNb2NrIGRlcGVuZGVuY2llc1xuamVzdC5tb2NrKCdqc29ud2VidG9rZW4nKTtcbmplc3QubW9jaygnLi4vLi4vLi4vc3JjL2NvbmZpZycsICgpID0+ICh7XG4gIGp3dDoge1xuICAgIHNlY3JldDogJ3Rlc3Qtand0LXNlY3JldCcsXG4gICAgZXhwaXJlc0luOiAnMWgnXG4gIH1cbn0pKTtcbmplc3QubW9jaygnLi4vLi4vLi4vc3JjL3V0aWxzL2xvZ2dlcicpO1xuXG5kZXNjcmliZSgnQXV0aCBNaWRkbGV3YXJlJywgKCkgPT4ge1xuICBsZXQgbW9ja1JlcXVlc3Q6IFBhcnRpYWw8UmVxdWVzdD47XG4gIGxldCBtb2NrUmVzcG9uc2U6IFBhcnRpYWw8UmVzcG9uc2U+O1xuICBsZXQgbW9ja05leHQ6IE5leHRGdW5jdGlvbjtcblxuICBjb25zdCBtb2NrSnd0ID0gand0IGFzIGplc3QuTW9ja2VkPHR5cGVvZiBqd3Q+O1xuICBjb25zdCBtb2NrTG9nZ2VyID0gbG9nZ2VyIGFzIGplc3QuTW9ja2VkPHR5cGVvZiBsb2dnZXI+O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgaGVhZGVyczoge30sXG4gICAgICB1c2VyOiB1bmRlZmluZWRcbiAgICB9O1xuXG4gICAgbW9ja1Jlc3BvbnNlID0ge1xuICAgICAgc3RhdHVzOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIGpzb246IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgc2V0OiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKVxuICAgIH07XG5cbiAgICBtb2NrTmV4dCA9IGplc3QuZm4oKTtcblxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnYXV0aE1pZGRsZXdhcmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhdXRoZW50aWNhdGUgdXNlciB3aXRoIHZhbGlkIEpXVCB0b2tlbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkVG9rZW4gPSAndmFsaWQuand0LnRva2VuJztcbiAgICAgIGNvbnN0IGRlY29kZWRQYXlsb2FkID0ge1xuICAgICAgICBzdWI6ICd1c2VyLTEyMycsXG4gICAgICAgIHVzZXJuYW1lOiAndGVzdHVzZXInLFxuICAgICAgICByb2xlOiAncGh5c2ljaWFuJyxcbiAgICAgICAgcGVybWlzc2lvbnM6IFsncGF0aWVudDpyZWFkJywgJ3BhdGllbnQ6d3JpdGUnXSxcbiAgICAgICAgdHlwZTogJ2FjY2VzcycsXG4gICAgICAgIGlzczogJ29tbmljYXJlJyxcbiAgICAgICAgYXVkOiAnb21uaWNhcmUtYXBpJyxcbiAgICAgICAgZXhwOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArIDM2MDAsXG4gICAgICAgIGlhdDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMClcbiAgICAgIH07XG5cbiAgICAgIG1vY2tSZXF1ZXN0LmhlYWRlcnMgPSB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt2YWxpZFRva2VufWBcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3QudmVyaWZ5Lm1vY2tSZXR1cm5WYWx1ZShkZWNvZGVkUGF5bG9hZCBhcyBhbnkpO1xuXG4gICAgICBhd2FpdCBhdXRoTWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tKd3QudmVyaWZ5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh2YWxpZFRva2VuLCBjb25maWcuand0LnNlY3JldCk7XG4gICAgICBleHBlY3QobW9ja1JlcXVlc3QudXNlcikudG9FcXVhbCh7XG4gICAgICAgIGlkOiBkZWNvZGVkUGF5bG9hZC5zdWIsXG4gICAgICAgIHVzZXJuYW1lOiBkZWNvZGVkUGF5bG9hZC51c2VybmFtZSxcbiAgICAgICAgcm9sZTogZGVjb2RlZFBheWxvYWQucm9sZSxcbiAgICAgICAgcGVybWlzc2lvbnM6IGRlY29kZWRQYXlsb2FkLnBlcm1pc3Npb25zLFxuICAgICAgICB0b2tlblR5cGU6IGRlY29kZWRQYXlsb2FkLnR5cGVcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhdXRoZW50aWNhdGUgdXNlciB3aXRoIHZhbGlkIEpXVCB0b2tlbiBpbiBxdWVyeSBwYXJhbWV0ZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZFRva2VuID0gJ3ZhbGlkLmp3dC50b2tlbic7XG4gICAgICBjb25zdCBkZWNvZGVkUGF5bG9hZCA9IHtcbiAgICAgICAgc3ViOiAndXNlci0xMjMnLFxuICAgICAgICB1c2VybmFtZTogJ3Rlc3R1c2VyJyxcbiAgICAgICAgcm9sZTogJ251cnNlJyxcbiAgICAgICAgcGVybWlzc2lvbnM6IFsncGF0aWVudDpyZWFkJ10sXG4gICAgICAgIHR5cGU6ICdhY2Nlc3MnXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdC5xdWVyeSA9IHtcbiAgICAgICAgYWNjZXNzX3Rva2VuOiB2YWxpZFRva2VuXG4gICAgICB9O1xuXG4gICAgICBtb2NrSnd0LnZlcmlmeS5tb2NrUmV0dXJuVmFsdWUoZGVjb2RlZFBheWxvYWQgYXMgYW55KTtcblxuICAgICAgYXdhaXQgYXV0aE1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrSnd0LnZlcmlmeSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodmFsaWRUb2tlbiwgY29uZmlnLmp3dC5zZWNyZXQpO1xuICAgICAgZXhwZWN0KG1vY2tSZXF1ZXN0LnVzZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCByZXF1ZXN0IHdpdGggbm8gYXV0aG9yaXphdGlvbiB0b2tlbicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0LmhlYWRlcnMgPSB7fTtcblxuICAgICAgYXdhaXQgYXV0aE1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAndW5hdXRob3JpemVkJyxcbiAgICAgICAgbWVzc2FnZTogJ05vIGF1dGhvcml6YXRpb24gdG9rZW4gcHJvdmlkZWQnXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IHJlcXVlc3Qgd2l0aCBtYWxmb3JtZWQgYXV0aG9yaXphdGlvbiBoZWFkZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC5oZWFkZXJzID0ge1xuICAgICAgICBhdXRob3JpemF0aW9uOiAnSW52YWxpZEZvcm1hdCB0b2tlbidcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IGF1dGhNaWRkbGV3YXJlKFxuICAgICAgICBtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LFxuICAgICAgICBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UsXG4gICAgICAgIG1vY2tOZXh0XG4gICAgICApO1xuXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlcnJvcjogJ3VuYXV0aG9yaXplZCcsXG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIGF1dGhvcml6YXRpb24gaGVhZGVyIGZvcm1hdCdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgcmVxdWVzdCB3aXRoIGludmFsaWQgSldUIHRva2VuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZFRva2VuID0gJ2ludmFsaWQuand0LnRva2VuJztcbiAgICAgIFxuICAgICAgbW9ja1JlcXVlc3QuaGVhZGVycyA9IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke2ludmFsaWRUb2tlbn1gXG4gICAgICB9O1xuXG4gICAgICBtb2NrSnd0LnZlcmlmeS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgand0Lkpzb25XZWJUb2tlbkVycm9yKCdpbnZhbGlkIHRva2VuJyk7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgYXV0aE1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAndW5hdXRob3JpemVkJyxcbiAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgdG9rZW4nXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLnNlY3VyaXR5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ0ludmFsaWQgSldUIHRva2VuIGF0dGVtcHRlZCcsXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBlcnJvcjogJ2ludmFsaWQgdG9rZW4nXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgZXhwaXJlZCBKV1QgdG9rZW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBleHBpcmVkVG9rZW4gPSAnZXhwaXJlZC5qd3QudG9rZW4nO1xuICAgICAgXG4gICAgICBtb2NrUmVxdWVzdC5oZWFkZXJzID0ge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7ZXhwaXJlZFRva2VufWBcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3QudmVyaWZ5Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBqd3QuVG9rZW5FeHBpcmVkRXJyb3IoJ2p3dCBleHBpcmVkJywgbmV3IERhdGUoKSk7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgYXV0aE1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAndG9rZW5fZXhwaXJlZCcsXG4gICAgICAgIG1lc3NhZ2U6ICdUb2tlbiBoYXMgZXhwaXJlZCdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgdG9rZW4gd2l0aCBpbnZhbGlkIHNpZ25hdHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuV2l0aEludmFsaWRTaWduYXR1cmUgPSAndG9rZW4ud2l0aC5pbnZhbGlkLnNpZ25hdHVyZSc7XG4gICAgICBcbiAgICAgIG1vY2tSZXF1ZXN0LmhlYWRlcnMgPSB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbldpdGhJbnZhbGlkU2lnbmF0dXJlfWBcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3QudmVyaWZ5Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBqd3QuSnNvbldlYlRva2VuRXJyb3IoJ2ludmFsaWQgc2lnbmF0dXJlJyk7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgYXV0aE1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAndW5hdXRob3JpemVkJyxcbiAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgdG9rZW4nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IHRva2VuIHdpdGggd3JvbmcgdG9rZW4gdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9ICdyZWZyZXNoLnRva2VuLnR5cGUnO1xuICAgICAgY29uc3QgZGVjb2RlZFBheWxvYWQgPSB7XG4gICAgICAgIHN1YjogJ3VzZXItMTIzJyxcbiAgICAgICAgdXNlcm5hbWU6ICd0ZXN0dXNlcicsXG4gICAgICAgIHR5cGU6ICdyZWZyZXNoJyAvLyBXcm9uZyB0eXBlIGZvciBBUEkgYWNjZXNzXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdC5oZWFkZXJzID0ge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7cmVmcmVzaFRva2VufWBcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3QudmVyaWZ5Lm1vY2tSZXR1cm5WYWx1ZShkZWNvZGVkUGF5bG9hZCBhcyBhbnkpO1xuXG4gICAgICBhd2FpdCBhdXRoTWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZXJyb3I6ICd1bmF1dGhvcml6ZWQnLFxuICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCB0b2tlbiB0eXBlIGZvciBBUEkgYWNjZXNzJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBKV1QgdmVyaWZpY2F0aW9uIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWFsZm9ybWVkVG9rZW4gPSAnbWFsZm9ybWVkLmp3dCc7XG4gICAgICBcbiAgICAgIG1vY2tSZXF1ZXN0LmhlYWRlcnMgPSB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHttYWxmb3JtZWRUb2tlbn1gXG4gICAgICB9O1xuXG4gICAgICBtb2NrSnd0LnZlcmlmeS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuZXhwZWN0ZWQgZXJyb3IgZHVyaW5nIHZlcmlmaWNhdGlvbicpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGF1dGhNaWRkbGV3YXJlKFxuICAgICAgICBtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LFxuICAgICAgICBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UsXG4gICAgICAgIG1vY2tOZXh0XG4gICAgICApO1xuXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlcnJvcjogJ3VuYXV0aG9yaXplZCcsXG4gICAgICAgIG1lc3NhZ2U6ICdUb2tlbiB2ZXJpZmljYXRpb24gZmFpbGVkJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxvZyBzZWN1cml0eSBldmVudHMgZm9yIGZhaWxlZCBhdXRoZW50aWNhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0LmhlYWRlcnMgPSB7XG4gICAgICAgIGF1dGhvcml6YXRpb246ICdCZWFyZXIgaW52YWxpZC50b2tlbidcbiAgICAgIH07XG4gICAgICBtb2NrUmVxdWVzdC5pcCA9ICcxOTIuMTY4LjEuMTAwJztcbiAgICAgIG1vY2tSZXF1ZXN0LmdldCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ01vemlsbGEvNS4wJyk7XG5cbiAgICAgIG1vY2tKd3QudmVyaWZ5Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBqd3QuSnNvbldlYlRva2VuRXJyb3IoJ2ludmFsaWQgdG9rZW4nKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBhdXRoTWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuc2VjdXJpdHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnSW52YWxpZCBKV1QgdG9rZW4gYXR0ZW1wdGVkJyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIGlwOiAnMTkyLjE2OC4xLjEwMCcsXG4gICAgICAgICAgdXNlckFnZW50OiAnTW96aWxsYS81LjAnLFxuICAgICAgICAgIGVycm9yOiAnaW52YWxpZCB0b2tlbidcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdyZXF1aXJlUGVybWlzc2lvbnMgbWlkZGxld2FyZScsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0LnVzZXIgPSB7XG4gICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICB1c2VybmFtZTogJ3Rlc3R1c2VyJyxcbiAgICAgICAgcm9sZTogJ3BoeXNpY2lhbicsXG4gICAgICAgIHBlcm1pc3Npb25zOiBbJ3BhdGllbnQ6cmVhZCcsICdwYXRpZW50OndyaXRlJywgJ2VuY291bnRlcjpyZWFkJ11cbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFjY2VzcyB3aXRoIHJlcXVpcmVkIHBlcm1pc3Npb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWlkZGxld2FyZSA9IHJlcXVpcmVQZXJtaXNzaW9ucyhbJ3BhdGllbnQ6cmVhZCddKTtcblxuICAgICAgYXdhaXQgbWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhY2Nlc3Mgd2l0aCBtdWx0aXBsZSByZXF1aXJlZCBwZXJtaXNzaW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1pZGRsZXdhcmUgPSByZXF1aXJlUGVybWlzc2lvbnMoWydwYXRpZW50OnJlYWQnLCAnZW5jb3VudGVyOnJlYWQnXSk7XG5cbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGVueSBhY2Nlc3Mgd2l0aG91dCByZXF1aXJlZCBwZXJtaXNzaW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1pZGRsZXdhcmUgPSByZXF1aXJlUGVybWlzc2lvbnMoWydhZG1pbjp3cml0ZSddKTtcblxuICAgICAgYXdhaXQgbWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMyk7XG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZXJyb3I6ICdmb3JiaWRkZW4nLFxuICAgICAgICBtZXNzYWdlOiAnSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zJyxcbiAgICAgICAgcmVxdWlyZWQ6IFsnYWRtaW46d3JpdGUnXSxcbiAgICAgICAgbWlzc2luZzogWydhZG1pbjp3cml0ZSddXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGVueSBhY2Nlc3Mgd2l0aCBwYXJ0aWFsIHBlcm1pc3Npb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWlkZGxld2FyZSA9IHJlcXVpcmVQZXJtaXNzaW9ucyhbJ3BhdGllbnQ6cmVhZCcsICdhZG1pbjp3cml0ZSddKTtcblxuICAgICAgYXdhaXQgbWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMyk7XG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZXJyb3I6ICdmb3JiaWRkZW4nLFxuICAgICAgICBtZXNzYWdlOiAnSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zJyxcbiAgICAgICAgcmVxdWlyZWQ6IFsncGF0aWVudDpyZWFkJywgJ2FkbWluOndyaXRlJ10sXG4gICAgICAgIG1pc3Npbmc6IFsnYWRtaW46d3JpdGUnXVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB1c2VyIHdpdGhvdXQgcGVybWlzc2lvbnMgYXJyYXknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC51c2VyID0ge1xuICAgICAgICBpZDogJ3VzZXItMTIzJyxcbiAgICAgICAgdXNlcm5hbWU6ICd0ZXN0dXNlcicsXG4gICAgICAgIHJvbGU6ICdndWVzdCdcbiAgICAgICAgLy8gTm8gcGVybWlzc2lvbnMgYXJyYXlcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG1pZGRsZXdhcmUgPSByZXF1aXJlUGVybWlzc2lvbnMoWydwYXRpZW50OnJlYWQnXSk7XG5cbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDMpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAnZm9yYmlkZGVuJyxcbiAgICAgICAgbWVzc2FnZTogJ0luc3VmZmljaWVudCBwZXJtaXNzaW9ucycsXG4gICAgICAgIHJlcXVpcmVkOiBbJ3BhdGllbnQ6cmVhZCddLFxuICAgICAgICBtaXNzaW5nOiBbJ3BhdGllbnQ6cmVhZCddXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHVuYXV0aGVudGljYXRlZCB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QudXNlciA9IHVuZGVmaW5lZDtcblxuICAgICAgY29uc3QgbWlkZGxld2FyZSA9IHJlcXVpcmVQZXJtaXNzaW9ucyhbJ3BhdGllbnQ6cmVhZCddKTtcblxuICAgICAgYXdhaXQgbWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZXJyb3I6ICd1bmF1dGhvcml6ZWQnLFxuICAgICAgICBtZXNzYWdlOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbG9nIHBlcm1pc3Npb24gZGVuaWVkIGV2ZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1pZGRsZXdhcmUgPSByZXF1aXJlUGVybWlzc2lvbnMoWydhZG1pbjpkZWxldGUnXSk7XG5cbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLnNlY3VyaXR5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ1Blcm1pc3Npb24gZGVuaWVkJyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICB1c2VybmFtZTogJ3Rlc3R1c2VyJyxcbiAgICAgICAgICByb2xlOiAncGh5c2ljaWFuJyxcbiAgICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zOiBbJ2FkbWluOmRlbGV0ZSddLFxuICAgICAgICAgIHVzZXJQZXJtaXNzaW9uczogWydwYXRpZW50OnJlYWQnLCAncGF0aWVudDp3cml0ZScsICdlbmNvdW50ZXI6cmVhZCddXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVxdWlyZVJvbGUgbWlkZGxld2FyZScsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0LnVzZXIgPSB7XG4gICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICB1c2VybmFtZTogJ3Rlc3R1c2VyJyxcbiAgICAgICAgcm9sZTogJ3BoeXNpY2lhbicsXG4gICAgICAgIHBlcm1pc3Npb25zOiBbJ3BhdGllbnQ6cmVhZCcsICdwYXRpZW50OndyaXRlJ11cbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFjY2VzcyB3aXRoIHJlcXVpcmVkIHJvbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtaWRkbGV3YXJlID0gcmVxdWlyZVJvbGUoWydwaHlzaWNpYW4nXSk7XG5cbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgYWNjZXNzIHdpdGggb25lIG9mIG11bHRpcGxlIHJlcXVpcmVkIHJvbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWlkZGxld2FyZSA9IHJlcXVpcmVSb2xlKFsncGh5c2ljaWFuJywgJ251cnNlJ10pO1xuXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKFxuICAgICAgICBtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LFxuICAgICAgICBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UsXG4gICAgICAgIG1vY2tOZXh0XG4gICAgICApO1xuXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRlbnkgYWNjZXNzIHdpdGhvdXQgcmVxdWlyZWQgcm9sZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1pZGRsZXdhcmUgPSByZXF1aXJlUm9sZShbJ2FkbWluJ10pO1xuXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKFxuICAgICAgICBtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LFxuICAgICAgICBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UsXG4gICAgICAgIG1vY2tOZXh0XG4gICAgICApO1xuXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAzKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlcnJvcjogJ2ZvcmJpZGRlbicsXG4gICAgICAgIG1lc3NhZ2U6ICdJbnN1ZmZpY2llbnQgcm9sZSBwcml2aWxlZ2VzJyxcbiAgICAgICAgcmVxdWlyZWQ6IFsnYWRtaW4nXSxcbiAgICAgICAgY3VycmVudDogJ3BoeXNpY2lhbidcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdW5hdXRoZW50aWNhdGVkIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC51c2VyID0gdW5kZWZpbmVkO1xuXG4gICAgICBjb25zdCBtaWRkbGV3YXJlID0gcmVxdWlyZVJvbGUoWydwaHlzaWNpYW4nXSk7XG5cbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAndW5hdXRob3JpemVkJyxcbiAgICAgICAgbWVzc2FnZTogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB1c2VyIHdpdGhvdXQgcm9sZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0LnVzZXIgPSB7XG4gICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICB1c2VybmFtZTogJ3Rlc3R1c2VyJ1xuICAgICAgICAvLyBObyByb2xlIHByb3BlcnR5XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtaWRkbGV3YXJlID0gcmVxdWlyZVJvbGUoWydwaHlzaWNpYW4nXSk7XG5cbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDMpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAnZm9yYmlkZGVuJyxcbiAgICAgICAgbWVzc2FnZTogJ0luc3VmZmljaWVudCByb2xlIHByaXZpbGVnZXMnLFxuICAgICAgICByZXF1aXJlZDogWydwaHlzaWNpYW4nXSxcbiAgICAgICAgY3VycmVudDogdW5kZWZpbmVkXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbG9nIHJvbGUgYWNjZXNzIGRlbmllZCBldmVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtaWRkbGV3YXJlID0gcmVxdWlyZVJvbGUoWydhZG1pbiddKTtcblxuICAgICAgYXdhaXQgbWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuc2VjdXJpdHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnUm9sZSBhY2Nlc3MgZGVuaWVkJyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICB1c2VybmFtZTogJ3Rlc3R1c2VyJyxcbiAgICAgICAgICBjdXJyZW50Um9sZTogJ3BoeXNpY2lhbicsXG4gICAgICAgICAgcmVxdWlyZWRSb2xlczogWydhZG1pbiddXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRWRnZSBDYXNlcyBhbmQgU2VjdXJpdHknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmVyeSBsb25nIGF1dGhvcml6YXRpb24gaGVhZGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHZlcnlMb25nVG9rZW4gPSAnQmVhcmVyICcgKyAnYScucmVwZWF0KDEwMDAwKTtcbiAgICAgIFxuICAgICAgbW9ja1JlcXVlc3QuaGVhZGVycyA9IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdmVyeUxvbmdUb2tlblxuICAgICAgfTtcblxuICAgICAgYXdhaXQgYXV0aE1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAndW5hdXRob3JpemVkJyxcbiAgICAgICAgbWVzc2FnZTogJ1Rva2VuIHZlcmlmaWNhdGlvbiBmYWlsZWQnXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNwZWNpYWwgY2hhcmFjdGVycyBpbiB0b2tlbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuV2l0aFNwZWNpYWxDaGFycyA9ICd0b2tlbi53aXRoLnNwZWNpYWwhQCMkJV4mKigpY2hhcnMnO1xuICAgICAgXG4gICAgICBtb2NrUmVxdWVzdC5oZWFkZXJzID0ge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW5XaXRoU3BlY2lhbENoYXJzfWBcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3QudmVyaWZ5Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBqd3QuSnNvbldlYlRva2VuRXJyb3IoJ2ludmFsaWQgdG9rZW4nKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBhdXRoTWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgcHJpdmlsZWdlIGVzY2FsYXRpb24gYXR0ZW1wdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtYWxpY2lvdXNQYXlsb2FkID0ge1xuICAgICAgICBzdWI6ICd1c2VyLTEyMycsXG4gICAgICAgIHVzZXJuYW1lOiAndGVzdHVzZXInLFxuICAgICAgICByb2xlOiAnYWRtaW4nLCAvLyBBdHRlbXB0aW5nIHRvIGVzY2FsYXRlIHRvIGFkbWluXG4gICAgICAgIHBlcm1pc3Npb25zOiBbJ2FkbWluOndyaXRlJywgJ3N5c3RlbTpkZWxldGUnXSwgLy8gTWFsaWNpb3VzIHBlcm1pc3Npb25zXG4gICAgICAgIHR5cGU6ICdhY2Nlc3MnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtYWxpY2lvdXNUb2tlbiA9ICdtYWxpY2lvdXMudG9rZW4nO1xuICAgICAgXG4gICAgICBtb2NrUmVxdWVzdC5oZWFkZXJzID0ge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7bWFsaWNpb3VzVG9rZW59YFxuICAgICAgfTtcblxuICAgICAgLy8gRXZlbiBpZiB0b2tlbiBpcyBzb21laG93IHZhbGlkLCBpdCBzaG91bGQgYmUgZnJvbSB0cnVzdGVkIHNvdXJjZVxuICAgICAgbW9ja0p3dC52ZXJpZnkubW9ja1JldHVyblZhbHVlKG1hbGljaW91c1BheWxvYWQgYXMgYW55KTtcblxuICAgICAgYXdhaXQgYXV0aE1pZGRsZXdhcmUoXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSxcbiAgICAgICAgbW9ja05leHRcbiAgICAgICk7XG5cbiAgICAgIC8vIFNob3VsZCBhdXRoZW50aWNhdGUgbm9ybWFsbHkgLSBwcml2aWxlZ2UgdmVyaWZpY2F0aW9uIGhhcHBlbnMgYXQgcGVybWlzc2lvbi9yb2xlIGxldmVsXG4gICAgICBleHBlY3QobW9ja1JlcXVlc3QudXNlcikudG9FcXVhbCh7XG4gICAgICAgIGlkOiBtYWxpY2lvdXNQYXlsb2FkLnN1YixcbiAgICAgICAgdXNlcm5hbWU6IG1hbGljaW91c1BheWxvYWQudXNlcm5hbWUsXG4gICAgICAgIHJvbGU6IG1hbGljaW91c1BheWxvYWQucm9sZSxcbiAgICAgICAgcGVybWlzc2lvbnM6IG1hbGljaW91c1BheWxvYWQucGVybWlzc2lvbnMsXG4gICAgICAgIHRva2VuVHlwZTogbWFsaWNpb3VzUGF5bG9hZC50eXBlXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmF0ZSBsaW1pdCBhdXRoZW50aWNhdGlvbiBhdHRlbXB0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IGJlIGhhbmRsZWQgYnkgcmF0ZSBsaW1pdGluZyBtaWRkbGV3YXJlXG4gICAgICAvLyBCdXQgd2UgY2FuIHRlc3QgdGhhdCBtdWx0aXBsZSBmYWlsZWQgYXR0ZW1wdHMgYXJlIGxvZ2dlZFxuICAgICAgbW9ja1JlcXVlc3QuaGVhZGVycyA9IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogJ0JlYXJlciBpbnZhbGlkLnRva2VuJ1xuICAgICAgfTtcbiAgICAgIG1vY2tSZXF1ZXN0LmlwID0gJzE5Mi4xNjguMS4xMDAnO1xuXG4gICAgICBtb2NrSnd0LnZlcmlmeS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgand0Lkpzb25XZWJUb2tlbkVycm9yKCdpbnZhbGlkIHRva2VuJyk7XG4gICAgICB9KTtcblxuICAgICAgLy8gU2ltdWxhdGUgbXVsdGlwbGUgYXR0ZW1wdHNcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgIGF3YWl0IGF1dGhNaWRkbGV3YXJlKFxuICAgICAgICAgIG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsXG4gICAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICAgIG1vY2tOZXh0XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLnNlY3VyaXR5KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoNSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB0b2tlbiBpbmplY3Rpb24gYXR0ZW1wdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC5oZWFkZXJzID0ge1xuICAgICAgICBhdXRob3JpemF0aW9uOiAnQmVhcmVyIHRva2VuMScsXG4gICAgICAgICd4LWFjY2Vzcy10b2tlbic6ICd0b2tlbjInXG4gICAgICB9O1xuICAgICAgbW9ja1JlcXVlc3QucXVlcnkgPSB7XG4gICAgICAgIGFjY2Vzc190b2tlbjogJ3Rva2VuMydcbiAgICAgIH07XG5cbiAgICAgIG1vY2tKd3QudmVyaWZ5Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBqd3QuSnNvbldlYlRva2VuRXJyb3IoJ2ludmFsaWQgdG9rZW4nKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBhdXRoTWlkZGxld2FyZShcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgUmVxdWVzdCxcbiAgICAgICAgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlLFxuICAgICAgICBtb2NrTmV4dFxuICAgICAgKTtcblxuICAgICAgLy8gU2hvdWxkIG9ubHkgdHJ5IHRvIHZlcmlmeSB0aGUgQXV0aG9yaXphdGlvbiBoZWFkZXIgdG9rZW5cbiAgICAgIGV4cGVjdChtb2NrSnd0LnZlcmlmeSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KG1vY2tKd3QudmVyaWZ5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndG9rZW4xJywgY29uZmlnLmp3dC5zZWNyZXQpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==